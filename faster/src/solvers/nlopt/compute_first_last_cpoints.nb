(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32207,        943]
NotebookOptionsPosition[     29227,        888]
NotebookOutlinePosition[     29597,        904]
CellTagsIndexPosition[     29554,        901]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.788972490555772*^9, 
  3.788972496044948*^9}},ExpressionUUID->"13910d4b-4b3c-492e-8f2a-\
42430f35133d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "q0"}], ",", "q1", ",", "q2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"q0", "\[Equal]", "p0"}], "&&", 
       RowBox[{"v0", "==", 
        FractionBox[
         RowBox[{"p", "*", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q0"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"tpP1", "-", "t1"}], ")"}]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q0", ",", "q1"}], "}"}]}], "]"}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"v1", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q1"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"t1PpP1", "-", "t2"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"a0", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"v1", "-", "v0"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tpP1", "-", "t2"}], ")"}]]}], ",", 
      RowBox[{"{", "q2", "}"}]}], "]"}], "//", "FullSimplify"}]}]}]], "Input",\

 CellChangeTimes->{{3.788985483264449*^9, 3.788985524960402*^9}, {
  3.788985586902481*^9, 3.788985610833024*^9}, {3.78898575664209*^9, 
  3.788985763765761*^9}},ExpressionUUID->"c5a8e35f-d462-4bbf-a20c-\
9bad1df73599"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q0", "\[Rule]", "p0"}], ",", 
    RowBox[{"q1", "\[Rule]", 
     RowBox[{"p0", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "t1"}], "+", "tpP1"}], ")"}], " ", "v0"}], "p"]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856114804087`*^9}},
 CellLabel->
  "Out[182]=",ExpressionUUID->"c41995ca-4514-4d5d-bf98-a624bbfaaeff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "qN"}], ",", "qNm1", ",", "qNm2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"qN", "\[Equal]", "pf"}], "&&", 
       RowBox[{"vf", "==", 
        FractionBox[
         RowBox[{"p", "*", 
          RowBox[{"(", 
           RowBox[{"qN", "-", "qNm1"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"tNPp", "-", "tN"}], ")"}]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"qN", ",", "qNm1"}], "}"}]}], "]"}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"vNm2", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qNm1", "-", "qNm2"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tNm1Pp", "-", "tNm1"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"af", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"vf", "-", "vNm2"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tNm1Pp", "-", "tN"}], ")"}]]}], ",", 
      RowBox[{"{", "qNm2", "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.788985769780929*^9, 3.788985832705647*^9}, {
  3.7889859248745213`*^9, 3.788985929962489*^9}, {3.788986149120821*^9, 
  3.788986149197049*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"1c6177d8-fc59-4b0d-b628-9931ff1d60c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qN", "\[Rule]", "pf"}], ",", 
    RowBox[{"qNm1", "\[Rule]", 
     RowBox[{"pf", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tN", "-", "tNPp"}], ")"}], " ", "vf"}], "p"]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856115592833`*^9}, 3.788985796915514*^9, 3.788985833106776*^9, {
   3.788985930611455*^9, 3.788985951937724*^9}, 3.788986152517634*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"5a0322ec-5fc1-4bf8-824c-7f01d95f700f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"qNm2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", "qNm1"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tNm1", "-", "tNm1Pp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"af", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "tN"}], "+", "tNm1Pp"}], ")"}]}], "+", "vf"}], 
        ")"}]}], "-", 
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"qNm1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "tNm1"}], "+", "tNm1Pp"}], ")"}], " ", "vf"}]}], 
        ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856115592833`*^9}, 3.788985796915514*^9, 3.788985833106776*^9, {
   3.788985930611455*^9, 3.788985951937724*^9}, 3.788986152577264*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"5973b0b0-db90-4f03-a20c-4f7bf5dbd2a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vf", "=", 
   FractionBox[
    RowBox[{"p", "*", 
     RowBox[{"(", 
      RowBox[{"qN", "-", "qNm1"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNPp", "-", "tN"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vNm2", "=", 
   FractionBox[
    RowBox[{"p", "*", 
     RowBox[{"(", 
      RowBox[{"qNm1", "-", "qNm2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNm1Pp", "-", "tNm1"}], ")"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"af", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"vf", "-", "vNm2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNm1Pp", "-", "tN"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qN"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm1"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm2"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qN"], 
   RowBox[{"(", 
    RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm1"], 
   RowBox[{"(", 
    RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "qNm2"], 
    RowBox[{"(", 
     RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789215524926556*^9, 3.789215672357794*^9}, {
  3.7892157523852987`*^9, 3.789215786893648*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"3382e6b4-2a7e-4f20-8028-b0ad844e92b0"],

Cell[BoxData[
 FractionBox["p", 
  RowBox[{
   RowBox[{"-", "tN"}], "+", "tNPp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787325656*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"32aab53a-71f5-4653-9f45-ee985063780d"],

Cell[BoxData[
 FractionBox["p", 
  RowBox[{"tN", "-", "tNPp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.7892157873288097`*^9}},
 CellLabel->"Out[51]=",ExpressionUUID->"e81619a3-1685-418c-9192-fa3ab1bd3825"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.78921578733213*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"e86870f2-ab64-4a99-a89b-edfdbf103ef0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"tN", "-", "tNm1Pp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"tN", "-", "tNPp"}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.7892157873375673`*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"d511aa40-18e8-46ee-af4f-45b51487cff4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"tNm1", "-", "tNm1Pp"}]], "+", 
     FractionBox["1", 
      RowBox[{"tN", "-", "tNPp"}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"-", "tN"}], "+", "tNm1Pp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787342004*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"98b76b63-ae4b-4010-a883-31be18416e7c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "tN"}], "+", "tNm1Pp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "tNm1"}], "+", "tNm1Pp"}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787344964*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"7e9fc5f9-05cd-4c31-8d6f-4e9e25d41eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NN", "=", "7"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"$Assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q0", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"q1", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"q2", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}]}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2", ",", " ", "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "2"}], 
     RowBox[{"NN", "-", "1"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"2", "*", 
        RowBox[{"Q", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "+", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm2"], "cost"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789481447023336*^9, 3.789481493402473*^9}, {
  3.789481528768776*^9, 3.78948153097654*^9}, {3.789481648170226*^9, 
  3.789481661640381*^9}, {3.789481700378883*^9, 3.789481837378282*^9}, {
  3.789481878882575*^9, 3.789481942117076*^9}, {3.78948216925528*^9, 
  3.789482170310238*^9}, {3.789482234214984*^9, 3.789482244351119*^9}, {
  3.789484863263303*^9, 3.7894849091587763`*^9}, {3.789484954534605*^9, 
  3.789485072744752*^9}, {3.789485130622232*^9, 3.789485133697946*^9}, {
  3.789485235979742*^9, 3.789485259050737*^9}, {3.7894858655559273`*^9, 
  3.789485870390175*^9}, {3.789486003797708*^9, 3.78948600802943*^9}, {
  3.789486158047029*^9, 3.7894861606382713`*^9}, {3.789896309728231*^9, 
  3.7898963112266893`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7274f37f-2dd0-4801-b976-63d19197850c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"(", 
    RowBox[{"q4", "-", "qNm2"}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"q3", "-", 
     RowBox[{"2", " ", "q4"}], "+", "qNm2"}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7894850923945208`*^9, 3.789485135191164*^9, {3.789485214627811*^9, 
   3.789485259177121*^9}, {3.789485443367826*^9, 3.789485448863782*^9}, {
   3.789485509265909*^9, 3.78948551074124*^9}, {3.789485865724083*^9, 
   3.789485870995126*^9}, {3.7894860039719152`*^9, 3.789486008172142*^9}, 
   3.7894861608350277`*^9, {3.789486361814286*^9, 3.789486362770523*^9}, 
   3.789896314072535*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"b492d0dd-ff8e-487e-a29c-1c5ab377f8f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "qN"}], ",", "qNm1", ",", "qNm2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"vi", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qiP1", "-", "qi"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tiPpP1", "-", "t1P1"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viP1", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qiP2", "-", "qiP1"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tiPpP2", "-", "t1P2"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"ai", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"viP1", "-", "q0"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tiPpP1", "-", "tiP2"}], ")"}]]}], ",", 
      RowBox[{"{", "qiP2", "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.790428416349018*^9, 3.7904284658097486`*^9}, {
  3.7904284974497843`*^9, 3.7904285735698338`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"88069599-2df9-4f93-9f40-006ed9c0762d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"qiP2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", "qiP1"}], "-", 
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"qiP1", "+", 
         RowBox[{"q0", " ", 
          RowBox[{"(", 
           RowBox[{"t1P2", "-", "tiPpP2"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q0", "+", 
         RowBox[{"ai", " ", 
          RowBox[{"(", 
           RowBox[{"tiP2", "-", "tiPpP1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"t1P2", "-", "tiPpP2"}], ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7904285742419167`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"0cd1f7a9-71c8-423d-a64f-9b7bb07b863c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2", ",", " ", "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "2"}], 
     RowBox[{"NN", "-", "1"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"2", "*", 
        RowBox[{"Q", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "+", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"D", "[", 
     RowBox[{"cost", ",", 
      RowBox[{"{", 
       RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", ".", "A", ".", "var"}], "-", "cost"}], " ", "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.790619461374023*^9, 3.790619466058573*^9}, {
   3.790619504907148*^9, 3.790619587175496*^9}, {3.790619631385745*^9, 
   3.790619742764646*^9}, 3.790619881558325*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"0b4c8741-1730-4cb0-acbf-aee85a17b195"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.790619461982753*^9, {3.790619518465966*^9, 3.790619531052561*^9}, {
   3.790619561221863*^9, 3.790619587860985*^9}, {3.790619679332781*^9, 
   3.790619719461905*^9}, 3.790619881995336*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"0193189b-9019-4ce7-868a-24e32f9dca8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "q4", " ", "es", " ", "el", " ", "nodo", " ", "del", " ", "cual", " ", 
     "quiero", " ", "calcular", " ", "el", " ", "h"}], "=", 
    RowBox[{"cost", "-", "to", "-", "go"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", "q5", 
     ",", "q6", ",", "q7", ",", "q8", ",", "q9", ",", " ", "qNm2", ",", " ", 
     "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cost", "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "5"}], "12"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"Q", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "+", 
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Empiezo", " ", "con", " ", "q4", " ", "en", " ", "el", " ", "medio"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", "  ", 
    RowBox[{"q5", ",", "q6", ",", "q7", ",", "q8", ",", "q9"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"cost", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"cost", "-", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"var", ".", "A", ".", "var"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"var", ",", "1"}], "}"}]}], "]"}]}], ";"}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"cost", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"var", ".", "A", ".", "var"}]}], "-", 
    RowBox[{"b", ".", "var"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"var", ".", "A", ".", "var"}]}], "+", 
   RowBox[{"b", ".", "var"}], "+", "c", " ", "-", " ", "cost"}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"c", "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "optimal", " ", "cost", " ", "to", " ", "the", " ", "opt", 
     " ", "problem", " ", "cost"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"x", "'"}], "Ax"}], " ", "+", " ", "bx", " ", "+", 
      RowBox[{"c", " ", "is", " ", "cost_optimal"}]}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], 
       RowBox[{"bA", "^", 
        RowBox[{"-", "1"}]}], 
       RowBox[{"b", "'"}]}], "+", "c"}]}]}], "*)"}], " "}]}], "Input",
 CellChangeTimes->{
  3.790619740840535*^9, {3.7906197813456593`*^9, 3.7906197987215147`*^9}, {
   3.790619830641755*^9, 3.7906198377371807`*^9}, 3.790619885871558*^9, {
   3.790619917442252*^9, 3.790619951294052*^9}, {3.790620070819825*^9, 
   3.790620072643903*^9}, {3.790620110285022*^9, 3.79062018527029*^9}, {
   3.7906202376955013`*^9, 3.7906202564528093`*^9}, {3.790620685390995*^9, 
   3.790620754154731*^9}, {3.790622071553068*^9, 3.790622074581959*^9}, {
   3.7906221475406027`*^9, 3.790622148323267*^9}, {3.790622224666353*^9, 
   3.790622246753208*^9}, {3.7906227164387817`*^9, 3.7906227254869747`*^9}, {
   3.7906227609122057`*^9, 3.790622761229147*^9}, {3.790622801830213*^9, 
   3.790622879351634*^9}, {3.7906229174765863`*^9, 3.790622959516493*^9}, {
   3.790623058261298*^9, 3.790623127213863*^9}, 3.7906237527650623`*^9, {
   3.790624123844036*^9, 3.790624184981221*^9}, {3.790624268550099*^9, 
   3.790624307771577*^9}, {3.79068094761721*^9, 3.7906809501404657`*^9}, {
   3.790681049060491*^9, 3.790681049508245*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"d5d0d391-d579-4dc1-ac57-87214064f668"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308502616*^9},
 CellLabel->
  "Out[599]=",ExpressionUUID->"2cd88189-8ed7-44d6-ae33-e54a93f1a177"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"12", 
      RowBox[{"-", "8"}], "2", "0", "0"},
     {
      RowBox[{"-", "8"}], "12", 
      RowBox[{"-", "8"}], "2", "0"},
     {"2", 
      RowBox[{"-", "8"}], "12", 
      RowBox[{"-", "8"}], "2"},
     {"0", "2", 
      RowBox[{"-", "8"}], "12", 
      RowBox[{"-", "8"}]},
     {"0", "0", "2", 
      RowBox[{"-", "8"}], "12"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308504469*^9},
 CellLabel->
  "Out[600]//MatrixForm=",ExpressionUUID->"85df25b9-4ff4-492c-8adb-\
3075bb30c34c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q3", "-", 
          RowBox[{"4", " ", "q4"}]}], ")"}]}]},
      {
       RowBox[{"2", " ", "q4"}]},
      {"0"},
      {
       RowBox[{"2", " ", "qNm2"}]},
      {
       RowBox[{
        RowBox[{"-", "6"}], " ", "qNm2"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308506579*^9},
 CellLabel->
  "Out[601]//MatrixForm=",ExpressionUUID->"cba322c0-ce0a-4bc2-b505-\
e70ef85d02fc"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q3", "2"], "-", 
  RowBox[{"4", " ", "q3", " ", "q4"}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q4", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["qNm2", "2"]}]}]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308525446*^9},
 CellLabel->
  "Out[602]=",ExpressionUUID->"65574ce2-3761-49f1-9820-7c92206074ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "A", "]"}], ".", "b"}], "//", "MatrixForm"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.790622114047122*^9, 3.7906221545451*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"2c0987ad-85eb-48f1-895a-1b57b386e9b0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "21"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"10", " ", "q1"}], "-", 
          RowBox[{"28", " ", "q2"}], "-", 
          RowBox[{"3", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "35"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"20", " ", "q1"}], "-", 
          RowBox[{"42", " ", "q2"}], "-", 
          RowBox[{"13", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "35"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"15", " ", "q1"}], "-", 
          RowBox[{"28", " ", "q2"}], "-", 
          RowBox[{"22", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "21"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "q1"}], "-", 
          RowBox[{"7", " ", "q2"}], "-", 
          RowBox[{"18", " ", "qNm2"}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.790622116670885*^9, 3.790622155143499*^9}},
 CellLabel->
  "Out[288]//MatrixForm=",ExpressionUUID->"98a4bb52-9889-4611-8c35-\
bac8cfb746e3"]
}, Open  ]]
},
WindowSize->{2495, 1416},
WindowMargins->{{1985, Automatic}, {Automatic, -117}},
Magnification:>1.7 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 152, 3, 53, "Input",ExpressionUUID->"13910d4b-4b3c-492e-8f2a-42430f35133d"],
Cell[CellGroupData[{
Cell[735, 27, 1674, 52, 355, "Input",ExpressionUUID->"c5a8e35f-d462-4bbf-a20c-9bad1df73599"],
Cell[2412, 81, 537, 17, 85, "Output",ExpressionUUID->"c41995ca-4514-4d5d-bf98-a624bbfaaeff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2986, 103, 1728, 53, 356, "Input",ExpressionUUID->"1c6177d8-fc59-4b0d-b628-9931ff1d60c4"],
Cell[4717, 158, 628, 17, 86, "Output",ExpressionUUID->"5a0322ec-5fc1-4bf8-824c-7f01d95f700f"],
Cell[5348, 177, 1162, 36, 91, "Output",ExpressionUUID->"5973b0b0-db90-4f03-a20c-4f7bf5dbd2a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6547, 218, 2139, 68, 593, "Input",ExpressionUUID->"3382e6b4-2a7e-4f20-8028-b0ad844e92b0"],
Cell[8689, 288, 314, 7, 81, "Output",ExpressionUUID->"32aab53a-71f5-4653-9f45-ee985063780d"],
Cell[9006, 297, 297, 6, 81, "Output",ExpressionUUID->"e81619a3-1685-418c-9192-fa3ab1bd3825"],
Cell[9306, 305, 247, 4, 59, "Output",ExpressionUUID->"e86870f2-ab64-4a99-a89b-edfdbf103ef0"],
Cell[9556, 311, 494, 14, 85, "Output",ExpressionUUID->"d511aa40-18e8-46ee-af4f-45b51487cff4"],
Cell[10053, 327, 582, 17, 107, "Output",ExpressionUUID->"98b76b63-ae4b-4010-a883-31be18416e7c"],
Cell[10638, 346, 538, 16, 85, "Output",ExpressionUUID->"7e9fc5f9-05cd-4c31-8d6f-4e9e25d41eb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11213, 367, 2557, 65, 379, "Input",ExpressionUUID->"7274f37f-2dd0-4801-b976-63d19197850c"],
Cell[13773, 434, 748, 17, 59, "Output",ExpressionUUID->"b492d0dd-ff8e-487e-a29c-1c5ab377f8f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14558, 456, 1378, 43, 325, "Input",ExpressionUUID->"88069599-2df9-4f93-9f40-006ed9c0762d"],
Cell[15939, 501, 895, 28, 91, "Output",ExpressionUUID->"0cd1f7a9-71c8-423d-a64f-9b7bb07b863c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16871, 534, 1738, 51, 340, "Input",ExpressionUUID->"0b4c8741-1730-4cb0-acbf-aee85a17b195"],
Cell[18612, 587, 320, 5, 59, "Output",ExpressionUUID->"0193189b-9019-4ce7-868a-24e32f9dca8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18969, 597, 4451, 119, 606, "Input",ExpressionUUID->"d5d0d391-d579-4dc1-ac57-87214064f668"],
Cell[23423, 718, 516, 8, 59, "Output",ExpressionUUID->"2cd88189-8ed7-44d6-ae33-e54a93f1a177"],
Cell[23942, 728, 1291, 35, 203, "Output",ExpressionUUID->"85df25b9-4ff4-492c-8adb-3075bb30c34c"],
Cell[25236, 765, 1298, 37, 203, "Output",ExpressionUUID->"cba322c0-ce0a-4bc2-b505-e70ef85d02fc"],
Cell[26537, 804, 718, 15, 59, "Output",ExpressionUUID->"65574ce2-3761-49f1-9820-7c92206074ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27292, 824, 304, 8, 53, "Input",ExpressionUUID->"2c0987ad-85eb-48f1-895a-1b57b386e9b0"],
Cell[27599, 834, 1612, 51, 228, "Output",ExpressionUUID->"98a4bb52-9889-4611-8c35-bac8cfb746e3"]
}, Open  ]]
}
]
*)


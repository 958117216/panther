(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    166344,       4782]
NotebookOptionsPosition[    156260,       4616]
NotebookOutlinePosition[    156630,       4632]
CellTagsIndexPosition[    156587,       4629]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.788972490555772*^9, 
  3.788972496044948*^9}},ExpressionUUID->"13910d4b-4b3c-492e-8f2a-\
42430f35133d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "q0"}], ",", "q1", ",", "q2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"q0", "\[Equal]", "p0"}], "&&", 
       RowBox[{"v0", "==", 
        FractionBox[
         RowBox[{"p", "*", 
          RowBox[{"(", 
           RowBox[{"q1", "-", "q0"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"tpP1", "-", "t1"}], ")"}]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q0", ",", "q1"}], "}"}]}], "]"}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"v1", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"q2", "-", "q1"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"t1PpP1", "-", "t2"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"a0", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"v1", "-", "v0"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tpP1", "-", "t2"}], ")"}]]}], ",", 
      RowBox[{"{", "q2", "}"}]}], "]"}], "//", "FullSimplify"}]}]}]], "Input",\

 CellChangeTimes->{{3.788985483264449*^9, 3.788985524960402*^9}, {
  3.788985586902481*^9, 3.788985610833024*^9}, {3.78898575664209*^9, 
  3.788985763765761*^9}},ExpressionUUID->"c5a8e35f-d462-4bbf-a20c-\
9bad1df73599"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q0", "\[Rule]", "p0"}], ",", 
    RowBox[{"q1", "\[Rule]", 
     RowBox[{"p0", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "t1"}], "+", "tpP1"}], ")"}], " ", "v0"}], "p"]}]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856114804087`*^9}},
 CellLabel->
  "Out[182]=",ExpressionUUID->"c41995ca-4514-4d5d-bf98-a624bbfaaeff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "qN"}], ",", "qNm1", ",", "qNm2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"qN", "\[Equal]", "pf"}], "&&", 
       RowBox[{"vf", "==", 
        FractionBox[
         RowBox[{"p", "*", 
          RowBox[{"(", 
           RowBox[{"qN", "-", "qNm1"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"tNPp", "-", "tN"}], ")"}]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"qN", ",", "qNm1"}], "}"}]}], "]"}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"vNm2", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qNm1", "-", "qNm2"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tNm1Pp", "-", "tNm1"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"af", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"vf", "-", "vNm2"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tNm1Pp", "-", "tN"}], ")"}]]}], ",", 
      RowBox[{"{", "qNm2", "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.788985769780929*^9, 3.788985832705647*^9}, {
  3.7889859248745213`*^9, 3.788985929962489*^9}, {3.788986149120821*^9, 
  3.788986149197049*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"1c6177d8-fc59-4b0d-b628-9931ff1d60c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qN", "\[Rule]", "pf"}], ",", 
    RowBox[{"qNm1", "\[Rule]", 
     RowBox[{"pf", "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tN", "-", "tNPp"}], ")"}], " ", "vf"}], "p"]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856115592833`*^9}, 3.788985796915514*^9, 3.788985833106776*^9, {
   3.788985930611455*^9, 3.788985951937724*^9}, 3.788986152517634*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"5a0322ec-5fc1-4bf8-824c-7f01d95f700f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"qNm2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", "qNm1"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tNm1", "-", "tNm1Pp"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"af", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "tN"}], "+", "tNm1Pp"}], ")"}]}], "+", "vf"}], 
        ")"}]}], "-", 
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"qNm1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "tNm1"}], "+", "tNm1Pp"}], ")"}], " ", "vf"}]}], 
        ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.78898549286747*^9, 3.788985525665703*^9, {3.788985593538587*^9, 
   3.7889856115592833`*^9}, 3.788985796915514*^9, 3.788985833106776*^9, {
   3.788985930611455*^9, 3.788985951937724*^9}, 3.788986152577264*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"5973b0b0-db90-4f03-a20c-4f7bf5dbd2a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vf", "=", 
   FractionBox[
    RowBox[{"p", "*", 
     RowBox[{"(", 
      RowBox[{"qN", "-", "qNm1"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNPp", "-", "tN"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vNm2", "=", 
   FractionBox[
    RowBox[{"p", "*", 
     RowBox[{"(", 
      RowBox[{"qNm1", "-", "qNm2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNm1Pp", "-", "tNm1"}], ")"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"af", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "-", "1"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"vf", "-", "vNm2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"tNm1Pp", "-", "tN"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qN"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm1"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm2"], 
   RowBox[{"(", 
    RowBox[{"vf", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qN"], 
   RowBox[{"(", 
    RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm1"], 
   RowBox[{"(", 
    RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", "qNm2"], 
    RowBox[{"(", 
     RowBox[{"af", "-", "finalVel"}], ")"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789215524926556*^9, 3.789215672357794*^9}, {
  3.7892157523852987`*^9, 3.789215786893648*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"3382e6b4-2a7e-4f20-8028-b0ad844e92b0"],

Cell[BoxData[
 FractionBox["p", 
  RowBox[{
   RowBox[{"-", "tN"}], "+", "tNPp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787325656*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"32aab53a-71f5-4653-9f45-ee985063780d"],

Cell[BoxData[
 FractionBox["p", 
  RowBox[{"tN", "-", "tNPp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.7892157873288097`*^9}},
 CellLabel->"Out[51]=",ExpressionUUID->"e81619a3-1685-418c-9192-fa3ab1bd3825"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.78921578733213*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"e86870f2-ab64-4a99-a89b-edfdbf103ef0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"tN", "-", "tNm1Pp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"tN", "-", "tNPp"}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.7892157873375673`*^9}},
 CellLabel->"Out[53]=",ExpressionUUID->"d511aa40-18e8-46ee-af4f-45b51487cff4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"tNm1", "-", "tNm1Pp"}]], "+", 
     FractionBox["1", 
      RowBox[{"tN", "-", "tNPp"}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"-", "tN"}], "+", "tNm1Pp"}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787342004*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"98b76b63-ae4b-4010-a883-31be18416e7c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "tN"}], "+", "tNm1Pp"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "tNm1"}], "+", "tNm1Pp"}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.789215617547274*^9, {3.789215654823732*^9, 3.789215672752303*^9}, {
   3.789215757853413*^9, 3.789215787344964*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"7e9fc5f9-05cd-4c31-8d6f-4e9e25d41eb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NN", "=", "7"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"$Assumptions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q0", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"q1", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}], ",", 
      RowBox[{"q2", "\[Element]", 
       RowBox[{"Matrices", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], ",", "Reals"}], "]"}]}]}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2", ",", " ", "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "2"}], 
     RowBox[{"NN", "-", "1"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"2", "*", 
        RowBox[{"Q", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "+", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[PartialD]", "qNm2"], "cost"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789481447023336*^9, 3.789481493402473*^9}, {
  3.789481528768776*^9, 3.78948153097654*^9}, {3.789481648170226*^9, 
  3.789481661640381*^9}, {3.789481700378883*^9, 3.789481837378282*^9}, {
  3.789481878882575*^9, 3.789481942117076*^9}, {3.78948216925528*^9, 
  3.789482170310238*^9}, {3.789482234214984*^9, 3.789482244351119*^9}, {
  3.789484863263303*^9, 3.7894849091587763`*^9}, {3.789484954534605*^9, 
  3.789485072744752*^9}, {3.789485130622232*^9, 3.789485133697946*^9}, {
  3.789485235979742*^9, 3.789485259050737*^9}, {3.7894858655559273`*^9, 
  3.789485870390175*^9}, {3.789486003797708*^9, 3.78948600802943*^9}, {
  3.789486158047029*^9, 3.7894861606382713`*^9}, {3.789896309728231*^9, 
  3.7898963112266893`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7274f37f-2dd0-4801-b976-63d19197850c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"(", 
    RowBox[{"q4", "-", "qNm2"}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"q3", "-", 
     RowBox[{"2", " ", "q4"}], "+", "qNm2"}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7894850923945208`*^9, 3.789485135191164*^9, {3.789485214627811*^9, 
   3.789485259177121*^9}, {3.789485443367826*^9, 3.789485448863782*^9}, {
   3.789485509265909*^9, 3.78948551074124*^9}, {3.789485865724083*^9, 
   3.789485870995126*^9}, {3.7894860039719152`*^9, 3.789486008172142*^9}, 
   3.7894861608350277`*^9, {3.789486361814286*^9, 3.789486362770523*^9}, 
   3.789896314072535*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"b492d0dd-ff8e-487e-a29c-1c5ab377f8f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compute", " ", "qN"}], ",", "qNm1", ",", "qNm2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"vi", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qiP1", "-", "qi"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tiPpP1", "-", "t1P1"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viP1", "=", 
     FractionBox[
      RowBox[{"p", "*", 
       RowBox[{"(", 
        RowBox[{"qiP2", "-", "qiP1"}], ")"}]}], 
      RowBox[{"(", 
       RowBox[{"tiPpP2", "-", "t1P2"}], ")"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"ai", "==", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "-", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"viP1", "-", "q0"}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{"tiPpP1", "-", "tiP2"}], ")"}]]}], ",", 
      RowBox[{"{", "qiP2", "}"}]}], "]"}], "//", 
    "FullSimplify"}]}]}]], "Input",
 CellChangeTimes->{{3.790428416349018*^9, 3.7904284658097486`*^9}, {
  3.7904284974497843`*^9, 3.7904285735698338`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"88069599-2df9-4f93-9f40-006ed9c0762d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"qiP2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", "qiP1"}], "-", 
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{"qiP1", "+", 
         RowBox[{"q0", " ", 
          RowBox[{"(", 
           RowBox[{"t1P2", "-", "tiPpP2"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q0", "+", 
         RowBox[{"ai", " ", 
          RowBox[{"(", 
           RowBox[{"tiP2", "-", "tiPpP1"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"t1P2", "-", "tiPpP2"}], ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p"}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7904285742419167`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"0cd1f7a9-71c8-423d-a64f-9b7bb07b863c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2", ",", " ", "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "2"}], 
     RowBox[{"NN", "-", "1"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"2", "*", 
        RowBox[{"Q", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "+", 
       RowBox[{"Q", "[", 
        RowBox[{"[", 
         RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", " ", 
     "qNm2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"D", "[", 
     RowBox[{"cost", ",", 
      RowBox[{"{", 
       RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", ".", "A", ".", "var"}], "-", "cost"}], " ", "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.790619461374023*^9, 3.790619466058573*^9}, {
   3.790619504907148*^9, 3.790619587175496*^9}, {3.790619631385745*^9, 
   3.790619742764646*^9}, 3.790619881558325*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"0b4c8741-1730-4cb0-acbf-aee85a17b195"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.790619461982753*^9, {3.790619518465966*^9, 3.790619531052561*^9}, {
   3.790619561221863*^9, 3.790619587860985*^9}, {3.790619679332781*^9, 
   3.790619719461905*^9}, 3.790619881995336*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"0193189b-9019-4ce7-868a-24e32f9dca8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "q4", " ", "es", " ", "el", " ", "nodo", " ", "del", " ", "cual", " ", 
     "quiero", " ", "calcular", " ", "el", " ", "h"}], "=", 
    RowBox[{"cost", "-", "to", "-", "go"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"{", 
    RowBox[{
    "q0", ",", "q1", ",", "q2", ",", " ", "q3", ",", " ", "q4", ",", "q5", 
     ",", "q6", ",", "q7", ",", "q8", ",", "q9", ",", " ", "qNm2", ",", " ", 
     "qNm2", ",", " ", "qNm2"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cost", "=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "7"}], "12"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"Q", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "+", 
        RowBox[{"Q", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}], "2"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Empiezo", " ", "con", " ", "q4", " ", "en", " ", "el", " ", "medio"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", "  ", 
    RowBox[{"q7", ",", "q8", ",", "q9"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"cost", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"cost", "-", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"var", ".", "A", ".", "var"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"var", ",", "1"}], "}"}]}], "]"}]}], ";"}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"cost", "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"var", ".", "A", ".", "var"}]}], "-", 
    RowBox[{"b", ".", "var"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"var", ".", "A", ".", "var"}]}], "+", 
   RowBox[{"b", ".", "var"}], "+", "c", " ", "-", " ", "cost"}], " ", "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"c", "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "optimal", " ", "cost", " ", "to", " ", "the", " ", "opt", 
     " ", "problem", " ", "cost"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"x", "'"}], "Ax"}], " ", "+", " ", "bx", " ", "+", 
      RowBox[{"c", " ", "is", " ", "cost_optimal"}]}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], 
       RowBox[{"bA", "^", 
        RowBox[{"-", "1"}]}], 
       RowBox[{"b", "'"}]}], "+", "c"}]}]}], "*)"}], " "}]}], "Input",
 CellChangeTimes->{
  3.790619740840535*^9, {3.7906197813456593`*^9, 3.7906197987215147`*^9}, {
   3.790619830641755*^9, 3.7906198377371807`*^9}, 3.790619885871558*^9, {
   3.790619917442252*^9, 3.790619951294052*^9}, {3.790620070819825*^9, 
   3.790620072643903*^9}, {3.790620110285022*^9, 3.79062018527029*^9}, {
   3.7906202376955013`*^9, 3.7906202564528093`*^9}, {3.790620685390995*^9, 
   3.790620754154731*^9}, {3.790622071553068*^9, 3.790622074581959*^9}, {
   3.7906221475406027`*^9, 3.790622148323267*^9}, {3.790622224666353*^9, 
   3.790622246753208*^9}, {3.7906227164387817`*^9, 3.7906227254869747`*^9}, {
   3.7906227609122057`*^9, 3.790622761229147*^9}, {3.790622801830213*^9, 
   3.790622879351634*^9}, {3.7906229174765863`*^9, 3.790622959516493*^9}, {
   3.790623058261298*^9, 3.790623127213863*^9}, 3.7906237527650623`*^9, {
   3.790624123844036*^9, 3.790624184981221*^9}, {3.790624268550099*^9, 
   3.790624307771577*^9}, {3.79068094761721*^9, 3.7906809501404657`*^9}, {
   3.790681049060491*^9, 3.790681059667656*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"d5d0d391-d579-4dc1-ac57-87214064f668"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308502616*^9, 3.790681065283029*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"3fea5026-982b-445b-9ac3-570e19c1e78e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"12", 
      RowBox[{"-", "8"}], "2"},
     {
      RowBox[{"-", "8"}], "12", 
      RowBox[{"-", "8"}]},
     {"2", 
      RowBox[{"-", "8"}], "12"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308502616*^9, 3.79068106528487*^9},
 CellLabel->
  "Out[42]//MatrixForm=",ExpressionUUID->"9ecfc488-f43b-41fd-b71a-\
2895c9da3bd5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q5", "-", 
          RowBox[{"4", " ", "q6"}]}], ")"}]}]},
      {
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"q6", "+", "qNm2"}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"-", "6"}], " ", "qNm2"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308502616*^9, 3.790681065286594*^9},
 CellLabel->
  "Out[43]//MatrixForm=",ExpressionUUID->"66dcb714-b2af-487a-b0a1-\
47f6f9e7f69f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q5", "2"], "-", 
  RowBox[{"4", " ", "q5", " ", "q6"}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["q6", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["qNm2", "2"]}]}]], "Output",
 CellChangeTimes->{{3.7906206894963017`*^9, 3.79062075479493*^9}, 
   3.79062207520372*^9, 3.790622149422908*^9, {3.790622228385311*^9, 
   3.7906222470337353`*^9}, 3.790622841313842*^9, {3.790622872376256*^9, 
   3.790622879974588*^9}, {3.790622914296575*^9, 3.79062296451588*^9}, 
   3.790623762186323*^9, {3.790624126374264*^9, 3.790624155680327*^9}, 
   3.7906242692380953`*^9, 3.790624308502616*^9, 3.790681065306131*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"486a55b2-bf8b-4cde-b3dd-1822a9b77719"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "A", "]"}], ".", "b"}], "//", "MatrixForm"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.790622114047122*^9, 3.7906221545451*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"2c0987ad-85eb-48f1-895a-1b57b386e9b0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "21"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"10", " ", "q1"}], "-", 
          RowBox[{"28", " ", "q2"}], "-", 
          RowBox[{"3", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "35"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"20", " ", "q1"}], "-", 
          RowBox[{"42", " ", "q2"}], "-", 
          RowBox[{"13", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "35"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"15", " ", "q1"}], "-", 
          RowBox[{"28", " ", "q2"}], "-", 
          RowBox[{"22", " ", "qNm2"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "21"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "q1"}], "-", 
          RowBox[{"7", " ", "q2"}], "-", 
          RowBox[{"18", " ", "qNm2"}]}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.790622116670885*^9, 3.790622155143499*^9}},
 CellLabel->
  "Out[288]//MatrixForm=",ExpressionUUID->"98a4bb52-9889-4611-8c35-\
bac8cfb746e3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"599708d3-08ef-42cb-92b1-eeb21aaa26f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", "*", "3"}]], "*", 
     RowBox[{
      TagBox[
       RowBox[{"(", GridBox[{
          {"1", "u", 
           RowBox[{"u", "*", "u"}], 
           RowBox[{"u", "*", "u", "*", "u"}]}
         }], ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ".", 
      RowBox[{"(", GridBox[{
         {"1", "4", 
          RowBox[{"-", "1"}], "0"},
         {
          RowBox[{"-", "3"}], "0", "3", "0"},
         {"3", 
          RowBox[{"-", "6"}], "3", "0"},
         {
          RowBox[{"-", "1"}], "3", 
          RowBox[{"-", "3"}], "1"}
        }], ")"}], ".", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", 
        TagBox[GridBox[{
           {"qiM3"},
           {"qiM2"},
           {"qiM1"},
           {"qi"}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.5599999999999999]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         Column], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.791738972931127*^9, 3.791739049654776*^9}, 
   3.7917390894483013`*^9, {3.791739149810359*^9, 3.791739237874872*^9}, {
   3.791739308759007*^9, 3.7917393396088467`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"fb728b87-753c-4f51-bf54-bffef4c25d00"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"times", "=", 
   TagBox[
    RowBox[{"(", GridBox[{
       {"1", "t", 
        RowBox[{"t", "*", "t"}], 
        RowBox[{"t", "*", "t", "*", "t"}]}
      }], ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"px", "=", 
   RowBox[{"times", ".", 
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"dx"},
        {"cx"},
        {"bx"},
        {"ax"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}]}]}], ";", 
  RowBox[{"py", "=", 
   RowBox[{"times", ".", 
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"dy"},
        {"cy"},
        {"by"},
        {"ay"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}]}]}], ";", 
  RowBox[{"pz", "=", 
   RowBox[{"times", ".", 
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"dz"},
        {"cz"},
        {"bz"},
        {"az"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.792329393897843*^9, 3.792329426280695*^9}, {
   3.792329465562796*^9, 3.7923295904400873`*^9}, 3.792329637692977*^9, {
   3.792329693004911*^9, 3.792329988897708*^9}, {3.792330021453321*^9, 
   3.792330033343191*^9}, {3.7923300660921097`*^9, 3.792330152336322*^9}, {
   3.79233021320149*^9, 3.792330213485097*^9}, {3.792330262591228*^9, 
   3.792330285017375*^9}, {3.79233032392904*^9, 3.7923303654839582`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"4eced7a3-b604-4b4c-98de-204ff0d90cdf"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"(", GridBox[{
      {"l1a", "0", "0", "l2a", "0", "0", "l3a", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}], "0", "0"},
      {"0", "l1a", "0", "0", "l2a", "0", "0", "l3a", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}], "0"},
      {"0", "0", "l1a", "0", "0", "l2a", "0", "0", "l3a", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}]},
      {"l1b", "0", "0", "l2b", "0", "0", "l3b", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}], "0", "0"},
      {"0", "l1b", "0", "0", "l2b", "0", "0", "l3b", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}], "0"},
      {"0", "0", "l1b", "0", "0", "l2b", "0", "0", "l3b", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}]},
      {"l1c", "0", "0", "l2c", "0", "0", "l3c", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}], "0", "0"},
      {"0", "l1c", "0", "0", "l2c", "0", "0", "l3c", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}], "0"},
      {"0", "0", "l1c", "0", "0", "l2c", "0", "0", "l3c", "0", "0", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}]},
      {"l1d", "0", "0", "l2d", "0", "0", "l3d", "0", "0", 
       RowBox[{"(", 
        RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], "0", "0"},
      {"0", "l1d", "0", "0", "l2d", "0", "0", "l3d", "0", "0", 
       RowBox[{"(", 
        RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], "0"},
      {"0", "0", "l1d", "0", "0", "l2d", "0", "0", "l3d", "0", "0", 
       RowBox[{"(", 
        RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {"x1", "x2", "x3", "x4"},
       {"y1", "y2", "y3", "y4"},
       {"z1", "z2", "z3", "z4"},
       {"1", "1", "1", "1"}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Det", "[", 
      RowBox[{"(", GridBox[{
         {"x1", "x2", "x3", "x4"},
         {"y1", "y2", "y3", "y4"},
         {"z1", "z2", "z3", "z4"},
         {"1", "1", "1", "1"}
        }], ")"}], "]"}], ",", 
     RowBox[{"ax", "\[Equal]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1a", "*", " ", "x1"}], "+", 
        RowBox[{"l2a", " ", "*", "x2"}], "+", 
        RowBox[{"l3a", "*", " ", "x3"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}], "*", " ", 
         "x4"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "ay"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1a", " ", "*", "y1"}], "+", 
       RowBox[{"l2a", " ", "*", "y2"}], "+", 
       RowBox[{"l3a", "*", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}], "*", " ", 
        "y4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "az"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1a", "*", " ", "z1"}], "+", 
       RowBox[{"l2a", "*", " ", "z2"}], "+", 
       RowBox[{"l3a", " ", "*", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1a"}], "-", "l2a", "-", "l3a"}], ")"}], " ", "*", 
        "z4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "bx"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1b", "*", " ", "x1"}], "+", 
       RowBox[{"l2b", "*", " ", "x2"}], "+", 
       RowBox[{"l3b", " ", "*", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}], "*", " ", 
        "x4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "by"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1b", " ", "*", "y1"}], "+", 
       RowBox[{"l2b", " ", "*", "y2"}], "+", 
       RowBox[{"l3b", " ", "*", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}], "*", " ", 
        "y4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "bz"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1b", " ", "*", "z1"}], "+", 
       RowBox[{"l2b", " ", "*", "z2"}], "+", 
       RowBox[{"l3b", "*", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1b"}], "-", "l2b", "-", "l3b"}], ")"}], "*", " ", 
        "z4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "cx"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1c", "*", " ", "x1"}], "+", 
       RowBox[{"l2c", "*", " ", "x2"}], "+", 
       RowBox[{"l3c", "*", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}], "*", " ", 
        "x4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "cy"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1c", " ", "*", "y1"}], "+", 
       RowBox[{"l2c", " ", "*", "y2"}], "+", 
       RowBox[{"l3c", "*", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}], "*", " ", 
        "y4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "cz"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1c", " ", "*", "z1"}], "+", 
       RowBox[{"l2c", " ", "*", "z2"}], "+", 
       RowBox[{"l3c", "*", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "l1c"}], "-", "l2c", "-", "l3c"}], ")"}], "*", " ", 
        "z4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "dx"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1d", " ", "*", "x1"}], "+", 
       RowBox[{"l2d", " ", "*", "x2"}], "+", 
       RowBox[{"l3d", "*", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], "*", " ", 
        "x4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "dy"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1d", " ", "*", "y1"}], "+", 
       RowBox[{"l2d", "*", " ", "y2"}], "+", 
       RowBox[{"l3d", "*", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], "*", " ", 
        "y4"}]}]}], ",", 
     RowBox[{
      RowBox[{"\\\[IndentingNewLine]", "dz"}], "\[Equal]", 
      RowBox[{
       RowBox[{"l1d", " ", "*", "z1"}], "+", 
       RowBox[{"l2d", "*", " ", "z2"}], "+", 
       RowBox[{"l3d", " ", "*", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], "*", " ", 
        "z4"}]}]}], ",", "\\\[IndentingNewLine]"}], "  ", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", 
     ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "l1a", ",", 
     "l2a", ",", "l3a", ",", "l1b", ",", "l2b", ",", "l3b", ",", "l1c", ",", 
     "l2c", ",", "l3c", ",", "l1d", ",", "l2d", ",", "l3d"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.792343398180849*^9, {3.792343464164925*^9, 3.7923434941825743`*^9}, {
   3.792343533838356*^9, 3.792343709850774*^9}, {3.792344258233279*^9, 
   3.7923443960366907`*^9}, {3.79234442836166*^9, 3.7923445139350843`*^9}, {
   3.792344562045176*^9, 3.79234456358182*^9}, {3.79234503627899*^9, 
   3.792345070426663*^9}, 3.792345101828533*^9, {3.792345133094611*^9, 
   3.792345242419757*^9}, {3.7923453988356533`*^9, 3.792345399250126*^9}, 
   3.7923456567886953`*^9, {3.792346316711912*^9, 3.792346333624463*^9}, {
   3.7923507131605253`*^9, 3.79235072826276*^9}, {3.792350930732977*^9, 
   3.79235094093928*^9}, 
   3.792355326812004*^9},ExpressionUUID->"b0fc30df-a69e-4b44-b23c-\
ede9719acd02"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{"(", GridBox[{
      {"v1x"},
      {"v1y"},
      {"v1z"}
     }], ")"}]}], ";", 
  RowBox[{"v2", "=", 
   RowBox[{"(", GridBox[{
      {"v2x"},
      {"v2y"},
      {"v2z"}
     }], ")"}]}], ";", 
  RowBox[{"v3", "=", 
   RowBox[{"(", GridBox[{
      {"v3x"},
      {"v3y"},
      {"v3z"}
     }], ")"}]}], ";", 
  RowBox[{"v4", "=", 
   RowBox[{"(", GridBox[{
      {"v4x"},
      {"v4y"},
      {"v4z"}
     }], ")"}]}], ";", 
  RowBox[{"M", "=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {"0", "0"}
     }], ")"}]}], ";", 
  RowBox[{"T", "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"t"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1", "=", 
   RowBox[{"(", GridBox[{
      {"s111", "s112"},
      {"s121", "s122"}
     }], ")"}]}], ";", 
  RowBox[{"S2", "=", 
   RowBox[{"(", GridBox[{
      {"s211", "s212"},
      {"s221", "s222"}
     }], ")"}]}], ";", 
  RowBox[{"S3", "=", 
   RowBox[{"(", GridBox[{
      {"s311", "s312"},
      {"s321", "s322"}
     }], ")"}]}], ";", 
  RowBox[{"S4", "=", 
   RowBox[{"(", GridBox[{
      {"s411", "s412"},
      {"s421", "s422"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "=", 
   RowBox[{"(", GridBox[{
      {"r111", "r112"},
      {"r121", "r122"}
     }], ")"}]}], ";", 
  RowBox[{"R2", "=", 
   RowBox[{"(", GridBox[{
      {"r211", "r212"},
      {"r221", "r222"}
     }], ")"}]}], ";", 
  RowBox[{"R3", "=", 
   RowBox[{"(", GridBox[{
      {"r311", "r312"},
      {"r321", "r322"}
     }], ")"}]}], ";", 
  RowBox[{"R4", "=", 
   RowBox[{"(", GridBox[{
      {"r411", "r412"},
      {"r421", "r422"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumRi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "R2", "]"}], ".", "R2"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "R3", "]"}], ".", "R3"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumSi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", "S1", "]"}], ".", "S1"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "S2", "]"}], ".", "S2"}], "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "S3", "]"}], ".", "S3"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R4TR4", "=", 
   RowBox[{"M", "-", "SumRi3"}]}], ";", 
  RowBox[{"S4TS4", "=", 
   RowBox[{"M", "-", "SumSi3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wwwwwwwwwwwwwwwwwwwwwwwwwwwwww", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumRivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "*", "v1x"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R2", "]"}], ".", "R2"}], "*", "v2x"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R3", "]"}], ".", "R3"}], "*", "v3x"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumSivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S1", "]"}], ".", "S1"}], "*", "v1x"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S2", "]"}], ".", "S2"}], "*", "v2x"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S3", "]"}], ".", "S3"}], "*", "v3x"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "T", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "*", 
       RowBox[{"(", 
        RowBox[{"SumSivi3", "-", "SumRivi3"}], ")"}]}], "+", "SumRivi3", "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", "*", 
          RowBox[{"(", 
           RowBox[{"S4TS4", "-", "R4TR4"}], ")"}]}], "+", "R4TR4"}], ")"}], 
       "*", "v4x"}]}], ")"}], " ", ".", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "0"}], "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "1"}], "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "2"}], "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"FullSimplify", "[", "dd", "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"FullSimplify", "[", "bb", "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"FullSimplify", "[", "cc", "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"FullSimplify", "[", "aa", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sx", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ax", "\[Equal]", "aa"}], "&&", 
      RowBox[{"bx", "\[Equal]", "bb"}], "&&", 
      RowBox[{"cx", "\[Equal]", "cc"}], "&&", 
      RowBox[{"dx", "\[Equal]", "dd"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"v1x", ",", "v2x", ",", "v3x", ",", "v4x"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumRivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "*", "v1y"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R2", "]"}], ".", "R2"}], "*", "v2y"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R3", "]"}], ".", "R3"}], "*", "v3y"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumSivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S1", "]"}], ".", "S1"}], "*", "v1y"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S2", "]"}], ".", "S2"}], "*", "v2y"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S3", "]"}], ".", "S3"}], "*", "v3y"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "T", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "*", 
       RowBox[{"(", 
        RowBox[{"SumSivi3", "-", "SumRivi3"}], ")"}]}], "+", "SumRivi3", "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", "*", 
          RowBox[{"(", 
           RowBox[{"S4TS4", "-", "R4TR4"}], ")"}]}], "+", "R4TR4"}], ")"}], 
       "*", "v4y"}]}], ")"}], " ", ".", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "0"}], "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "1"}], "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "2"}], "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"FullSimplify", "[", "dd", "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"FullSimplify", "[", "bb", "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"FullSimplify", "[", "cc", "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"FullSimplify", "[", "aa", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sy", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ay", "\[Equal]", "aa"}], "&&", 
      RowBox[{"by", "\[Equal]", "bb"}], "&&", 
      RowBox[{"cy", "\[Equal]", "cc"}], "&&", 
      RowBox[{"dy", "\[Equal]", "dd"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"v1y", ",", "v2y", ",", "v3y", ",", "v4y"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumRivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "*", "v1z"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R2", "]"}], ".", "R2"}], "*", "v2z"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "R3", "]"}], ".", "R3"}], "*", "v3z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SumSivi3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S1", "]"}], ".", "S1"}], "*", "v1z"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S2", "]"}], ".", "S2"}], "*", "v2z"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "S3", "]"}], ".", "S3"}], "*", "v3z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "T", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "*", 
       RowBox[{"(", 
        RowBox[{"SumSivi3", "-", "SumRivi3"}], ")"}]}], "+", "SumRivi3", "+", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", "*", 
          RowBox[{"(", 
           RowBox[{"S4TS4", "-", "R4TR4"}], ")"}]}], "+", "R4TR4"}], ")"}], 
       "*", "v4z"}]}], ")"}], " ", ".", "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
  RowBox[{"polynomial", "=", 
   RowBox[{"polynomial", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "0"}], "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "1"}], "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "2"}], "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"polynomial", ",", "t", ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd", "=", 
   RowBox[{"FullSimplify", "[", "dd", "]"}]}], ";", 
  RowBox[{"bb", "=", 
   RowBox[{"FullSimplify", "[", "bb", "]"}]}], ";", 
  RowBox[{"cc", "=", 
   RowBox[{"FullSimplify", "[", "cc", "]"}]}], ";", 
  RowBox[{"aa", "=", 
   RowBox[{"FullSimplify", "[", "aa", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sz", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"az", "\[Equal]", "aa"}], "&&", 
       RowBox[{"bz", "\[Equal]", "bb"}], "&&", 
       RowBox[{"cz", "\[Equal]", "cc"}], "&&", 
       RowBox[{"dz", "\[Equal]", "dd"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"v1z", ",", "v2z", ",", "v3z", ",", "v4z"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.792433841913527*^9, 3.792433882590333*^9}, {
   3.792434770938624*^9, 3.792435002891844*^9}, {3.792435047425043*^9, 
   3.7924351871738663`*^9}, {3.792435244286643*^9, 3.792435442467475*^9}, {
   3.7924355265552273`*^9, 3.7924355712507133`*^9}, {3.792435607931287*^9, 
   3.792435678903282*^9}, {3.792435718387941*^9, 3.792435726091772*^9}, {
   3.792435809392187*^9, 3.792435854324037*^9}, {3.792435887077148*^9, 
   3.792435912188054*^9}, {3.7924359445358067`*^9, 3.792435948204404*^9}, {
   3.792436001712407*^9, 3.792436114708818*^9}, {3.79243721358685*^9, 
   3.792437227332314*^9}, {3.792437311992168*^9, 3.79243732418615*^9}, {
   3.7924378715050783`*^9, 3.792437878806972*^9}, 3.792438558275345*^9, {
   3.792438660008746*^9, 3.792438662373289*^9}, {3.7924397326276073`*^9, 
   3.792440109951457*^9}, {3.792440265392562*^9, 3.7924402677646503`*^9}, {
   3.792491136274045*^9, 3.7924912337080507`*^9}, {3.7924916885679502`*^9, 
   3.7924917363291607`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"63c6debf-21ad-47c6-9f59-477455df2d4b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7924913561664867`*^9, 3.792491360170664*^9}, 
   3.7924921647205973`*^9},ExpressionUUID->"a8d1777d-498c-4af3-82eb-\
736f74712c3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {"v1x", "v2x", "v3x", "v4x"},
       {"v1y", "v2y", "v3y", "v4y"},
       {"v1z", "v2z", "v3z", "v4z"},
       {"1", "1", "1", "1"}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{"cost", "/.", 
    RowBox[{"sx", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{"cost", "/.", 
    RowBox[{"sy", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cost", "=", 
   RowBox[{"cost", "/.", 
    RowBox[{"sz", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7924379224206448`*^9, 3.792437958234531*^9}, 
   3.792439700241311*^9, {3.792440134325617*^9, 3.7924401811196947`*^9}, {
   3.792440221506443*^9, 3.792440257777424*^9}, {3.792440363004504*^9, 
   3.792440366280102*^9}, {3.792440503088797*^9, 3.792440503350728*^9}, {
   3.792440561884652*^9, 3.7924405621464863`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"0ad9f8f6-12ec-4454-850d-d84ec7303948"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", "cost", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "s111", ",", "s112", ",", "s121", ",", "s122", ",", "s211", ",", "s212", 
      ",", "s221", ",", "s222", ",", "s311", ",", "s312", ",", "s321", ",", 
      "s322", ",", "s411", ",", "s412", ",", "s421", ",", "s422", ",", "r111",
       ",", "r112", ",", "r121", ",", "r122", ",", "r211", ",", "r212", ",", 
      "r221", ",", "r222", ",", "r311", ",", "r312", ",", "r321", ",", "r322",
       ",", "r411", ",", "r412", ",", "r421", ",", "r422"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792440619258169*^9, 3.7924407796404467`*^9}, {
  3.7924408156141*^9, 3.792440854173624*^9}, {3.7924912504555683`*^9, 
  3.792491290721895*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"d8037bad-59ac-48e7-9dc4-5c1de60656f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"(", GridBox[{
      {"w11", "w12"},
      {"w12", "w22"}
     }], ")"}]}], ";", 
  RowBox[{"V", "=", 
   RowBox[{"(", GridBox[{
      {"v11", "v12"},
      {"v12", "v22"}
     }], ")"}]}], ";", 
  RowBox[{"T", "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"t"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polynomial", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "T", "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "*", "W"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "t"}], ")"}], "*", "V"}]}], ")"}], " ", ".", 
    "T"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"dd", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"polynomial", ",", "t", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"polynomial", ",", "t", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bb", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"polynomial", ",", "t", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aa", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"polynomial", ",", "t", ",", "3"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.79277808122757*^9, 3.79277820647023*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"52a815ea-18b2-4465-8553-bf583ed6d2d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "v11", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.792778207435663*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"6f78d8c3-d8f4-4ef9-a70b-8f0105ae833b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "v11"}], "+", 
    RowBox[{"2", " ", "v12"}], "+", "w11"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.792778207444521*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"20b2b14a-244f-400c-97c9-8fcab7f09c6a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "v12"}], "+", "v22", "+", 
    RowBox[{"2", " ", "w12"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.792778207450416*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"28f583e8-d345-4702-8fcb-69cbb5f26689"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "v22"}], "+", "w22"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.79277820745675*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"ef3573f7-8e58-4a47-8c37-0a6caf2fc9c3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"(", GridBox[{
     {"\[SelectionPlaceholder]", "\[Placeholder]", "\[Placeholder]", 
      "\[Placeholder]"},
     {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
      "\[Placeholder]"},
     {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
      "\[Placeholder]"},
     {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.792787481684066*^9, 3.7927874818478527`*^9}, {
  3.792787519887969*^9, 
  3.79278754031736*^9}},ExpressionUUID->"9b7f3a75-90ee-47da-89bd-\
0e40e81c61bd"],

Cell[CellGroupData[{

Cell[BoxData["ax"], "Input",
 CellChangeTimes->{{3.792436052790268*^9, 3.792436053034342*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"ffb16e15-22fe-4df9-8071-0d2aa714956d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["r112", "2"]}], " ", "v1x"}], "-", 
  RowBox[{
   SuperscriptBox["r122", "2"], " ", "v1x"}], "+", 
  RowBox[{
   SuperscriptBox["s112", "2"], " ", "v1x"}], "+", 
  RowBox[{
   SuperscriptBox["s122", "2"], " ", "v1x"}], "-", 
  RowBox[{
   SuperscriptBox["r212", "2"], " ", "v2x"}], "-", 
  RowBox[{
   SuperscriptBox["r222", "2"], " ", "v2x"}], "+", 
  RowBox[{
   SuperscriptBox["s212", "2"], " ", "v2x"}], "+", 
  RowBox[{
   SuperscriptBox["s222", "2"], " ", "v2x"}], "-", 
  RowBox[{
   SuperscriptBox["r312", "2"], " ", "v3x"}], "-", 
  RowBox[{
   SuperscriptBox["r322", "2"], " ", "v3x"}], "+", 
  RowBox[{
   SuperscriptBox["s312", "2"], " ", "v3x"}], "+", 
  RowBox[{
   SuperscriptBox["s322", "2"], " ", "v3x"}], "+", 
  RowBox[{
   SuperscriptBox["r112", "2"], " ", "v4x"}], "+", 
  RowBox[{
   SuperscriptBox["r122", "2"], " ", "v4x"}], "+", 
  RowBox[{
   SuperscriptBox["r212", "2"], " ", "v4x"}], "+", 
  RowBox[{
   SuperscriptBox["r222", "2"], " ", "v4x"}], "+", 
  RowBox[{
   SuperscriptBox["r312", "2"], " ", "v4x"}], "+", 
  RowBox[{
   SuperscriptBox["r322", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s112", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s122", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s212", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s222", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s312", "2"], " ", "v4x"}], "-", 
  RowBox[{
   SuperscriptBox["s322", "2"], " ", "v4x"}]}]], "Output",
 CellChangeTimes->{3.7924360535104647`*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"19647d73-6a2c-4d64-914e-a4dbb90c8c2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["polynomial"], "Input",
 CellLabel->
  "In[235]:=",ExpressionUUID->"f514e9f4-82cf-4b1e-9bce-2b94a2fad63e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r111", "2"], "+", 
     SuperscriptBox["r121", "2"]}], ")"}], " ", "v1x"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r211", "2"], "+", 
     SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r311", "2"], "+", 
     SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r111", "2"], "+", 
         SuperscriptBox["r121", "2"]}], ")"}]}], " ", "v1x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["s111", "2"], "+", 
        SuperscriptBox["s121", "2"]}], ")"}], " ", "v1x"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r211", "2"], "+", 
        SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["s211", "2"], "+", 
        SuperscriptBox["s221", "2"]}], ")"}], " ", "v2x"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r311", "2"], "+", 
        SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["s311", "2"], "+", 
        SuperscriptBox["s321", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["r111", "2"], "-", 
     SuperscriptBox["r121", "2"], "-", 
     SuperscriptBox["r211", "2"], "-", 
     SuperscriptBox["r221", "2"], "-", 
     SuperscriptBox["r311", "2"], "-", 
     SuperscriptBox["r321", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r111", "2"], "+", 
        SuperscriptBox["r121", "2"], "+", 
        SuperscriptBox["r211", "2"], "+", 
        SuperscriptBox["r221", "2"], "+", 
        SuperscriptBox["r311", "2"], "+", 
        SuperscriptBox["r321", "2"], "-", 
        SuperscriptBox["s111", "2"], "-", 
        SuperscriptBox["s121", "2"], "-", 
        SuperscriptBox["s211", "2"], "-", 
        SuperscriptBox["s221", "2"], "-", 
        SuperscriptBox["s311", "2"], "-", 
        SuperscriptBox["s321", "2"]}], ")"}], " ", "t"}]}], ")"}], " ", 
   "v4x"}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r111", " ", "r112"}], "+", 
        RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r211", " ", "r212"}], "+", 
        RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r311", " ", "r312"}], "+", 
        RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r111", " ", "r112"}], "+", 
            RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s111", " ", "s112"}], "+", 
           RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r211", " ", "r212"}], "+", 
           RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s211", " ", "s212"}], "+", 
           RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r311", " ", "r312"}], "+", 
           RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s311", " ", "s312"}], "+", 
           RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r111"}], " ", "r112"}], "-", 
        RowBox[{"r121", " ", "r122"}], "-", 
        RowBox[{"r211", " ", "r212"}], "-", 
        RowBox[{"r221", " ", "r222"}], "-", 
        RowBox[{"r311", " ", "r312"}], "-", 
        RowBox[{"r321", " ", "r322"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r111", " ", "r112"}], "+", 
           RowBox[{"r121", " ", "r122"}], "+", 
           RowBox[{"r211", " ", "r212"}], "+", 
           RowBox[{"r221", " ", "r222"}], "+", 
           RowBox[{"r311", " ", "r312"}], "+", 
           RowBox[{"r321", " ", "r322"}], "-", 
           RowBox[{"s111", " ", "s112"}], "-", 
           RowBox[{"s121", " ", "s122"}], "-", 
           RowBox[{"s211", " ", "s212"}], "-", 
           RowBox[{"s221", " ", "s222"}], "-", 
           RowBox[{"s311", " ", "s312"}], "-", 
           RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ", 
      "v4x"}]}], ")"}]}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r111", " ", "r112"}], "+", 
        RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r211", " ", "r212"}], "+", 
        RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r311", " ", "r312"}], "+", 
        RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r111", " ", "r112"}], "+", 
            RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s111", " ", "s112"}], "+", 
           RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r211", " ", "r212"}], "+", 
           RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s211", " ", "s212"}], "+", 
           RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r311", " ", "r312"}], "+", 
           RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s311", " ", "s312"}], "+", 
           RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
     "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r111"}], " ", "r112"}], "-", 
        RowBox[{"r121", " ", "r122"}], "-", 
        RowBox[{"r211", " ", "r212"}], "-", 
        RowBox[{"r221", " ", "r222"}], "-", 
        RowBox[{"r311", " ", "r312"}], "-", 
        RowBox[{"r321", " ", "r322"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r111", " ", "r112"}], "+", 
           RowBox[{"r121", " ", "r122"}], "+", 
           RowBox[{"r211", " ", "r212"}], "+", 
           RowBox[{"r221", " ", "r222"}], "+", 
           RowBox[{"r311", " ", "r312"}], "+", 
           RowBox[{"r321", " ", "r322"}], "-", 
           RowBox[{"s111", " ", "s112"}], "-", 
           RowBox[{"s121", " ", "s122"}], "-", 
           RowBox[{"s211", " ", "s212"}], "-", 
           RowBox[{"s221", " ", "s222"}], "-", 
           RowBox[{"s311", " ", "s312"}], "-", 
           RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ", 
      "v4x"}], "+", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r112", "2"], "+", 
           SuperscriptBox["r122", "2"]}], ")"}], " ", "v1x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r212", "2"], "+", 
           SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r312", "2"], "+", 
           SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
        RowBox[{"t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r112", "2"], "+", 
               SuperscriptBox["r122", "2"]}], ")"}]}], " ", "v1x"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["s112", "2"], "+", 
              SuperscriptBox["s122", "2"]}], ")"}], " ", "v1x"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r212", "2"], "+", 
              SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["s212", "2"], "+", 
              SuperscriptBox["s222", "2"]}], ")"}], " ", "v2x"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r312", "2"], "+", 
              SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["s312", "2"], "+", 
              SuperscriptBox["s322", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["r112", "2"]}], "-", 
           SuperscriptBox["r122", "2"], "-", 
           SuperscriptBox["r212", "2"], "-", 
           SuperscriptBox["r222", "2"], "-", 
           SuperscriptBox["r312", "2"], "-", 
           SuperscriptBox["r322", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r112", "2"], "+", 
              SuperscriptBox["r122", "2"], "+", 
              SuperscriptBox["r212", "2"], "+", 
              SuperscriptBox["r222", "2"], "+", 
              SuperscriptBox["r312", "2"], "+", 
              SuperscriptBox["r322", "2"], "-", 
              SuperscriptBox["s112", "2"], "-", 
              SuperscriptBox["s122", "2"], "-", 
              SuperscriptBox["s212", "2"], "-", 
              SuperscriptBox["s222", "2"], "-", 
              SuperscriptBox["s312", "2"], "-", 
              SuperscriptBox["s322", "2"]}], ")"}], " ", "t"}]}], ")"}], " ", 
         "v4x"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.792436023820703*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"cf3d22b7-2c4a-49db-b0d1-070295f21364"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["polynomial"], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"9c75bd1a-2866-4f18-94dd-1e27743465eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r111", "2"], "+", 
      SuperscriptBox["r121", "2"]}], ")"}], " ", "v1x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r211", "2"], "+", 
      SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r311", "2"], "+", 
      SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
   RowBox[{"t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r111", "2"], "+", 
          SuperscriptBox["r121", "2"]}], ")"}]}], " ", "v1x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["s111", "2"], "+", 
         SuperscriptBox["s121", "2"]}], ")"}], " ", "v1x"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r211", "2"], "+", 
         SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["s211", "2"], "+", 
         SuperscriptBox["s221", "2"]}], ")"}], " ", "v2x"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r311", "2"], "+", 
         SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["s311", "2"], "+", 
         SuperscriptBox["s321", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["r111", "2"], "-", 
      SuperscriptBox["r121", "2"], "-", 
      SuperscriptBox["r211", "2"], "-", 
      SuperscriptBox["r221", "2"], "-", 
      SuperscriptBox["r311", "2"], "-", 
      SuperscriptBox["r321", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r111", "2"], "+", 
         SuperscriptBox["r121", "2"], "+", 
         SuperscriptBox["r211", "2"], "+", 
         SuperscriptBox["r221", "2"], "+", 
         SuperscriptBox["r311", "2"], "+", 
         SuperscriptBox["r321", "2"], "-", 
         SuperscriptBox["s111", "2"], "-", 
         SuperscriptBox["s121", "2"], "-", 
         SuperscriptBox["s211", "2"], "-", 
         SuperscriptBox["s221", "2"], "-", 
         SuperscriptBox["s311", "2"], "-", 
         SuperscriptBox["s321", "2"]}], ")"}], " ", "t"}]}], ")"}], " ", 
    "v4x"}], "+", 
   RowBox[{"t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r111", " ", "r112"}], "+", 
         RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r211", " ", "r212"}], "+", 
         RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r311", " ", "r312"}], "+", 
         RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r111", " ", "r112"}], "+", 
             RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s111", " ", "s112"}], "+", 
            RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r211", " ", "r212"}], "+", 
            RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s211", " ", "s212"}], "+", 
            RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r311", " ", "r312"}], "+", 
            RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s311", " ", "s312"}], "+", 
            RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r111"}], " ", "r112"}], "-", 
         RowBox[{"r121", " ", "r122"}], "-", 
         RowBox[{"r211", " ", "r212"}], "-", 
         RowBox[{"r221", " ", "r222"}], "-", 
         RowBox[{"r311", " ", "r312"}], "-", 
         RowBox[{"r321", " ", "r322"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r111", " ", "r112"}], "+", 
            RowBox[{"r121", " ", "r122"}], "+", 
            RowBox[{"r211", " ", "r212"}], "+", 
            RowBox[{"r221", " ", "r222"}], "+", 
            RowBox[{"r311", " ", "r312"}], "+", 
            RowBox[{"r321", " ", "r322"}], "-", 
            RowBox[{"s111", " ", "s112"}], "-", 
            RowBox[{"s121", " ", "s122"}], "-", 
            RowBox[{"s211", " ", "s212"}], "-", 
            RowBox[{"s221", " ", "s222"}], "-", 
            RowBox[{"s311", " ", "s312"}], "-", 
            RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ", 
       "v4x"}]}], ")"}]}], "+", 
   RowBox[{"t", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r111", " ", "r112"}], "+", 
         RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r211", " ", "r212"}], "+", 
         RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r311", " ", "r312"}], "+", 
         RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r111", " ", "r112"}], "+", 
             RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s111", " ", "s112"}], "+", 
            RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r211", " ", "r212"}], "+", 
            RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s211", " ", "s212"}], "+", 
            RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r311", " ", "r312"}], "+", 
            RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s311", " ", "s312"}], "+", 
            RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r111"}], " ", "r112"}], "-", 
         RowBox[{"r121", " ", "r122"}], "-", 
         RowBox[{"r211", " ", "r212"}], "-", 
         RowBox[{"r221", " ", "r222"}], "-", 
         RowBox[{"r311", " ", "r312"}], "-", 
         RowBox[{"r321", " ", "r322"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r111", " ", "r112"}], "+", 
            RowBox[{"r121", " ", "r122"}], "+", 
            RowBox[{"r211", " ", "r212"}], "+", 
            RowBox[{"r221", " ", "r222"}], "+", 
            RowBox[{"r311", " ", "r312"}], "+", 
            RowBox[{"r321", " ", "r322"}], "-", 
            RowBox[{"s111", " ", "s112"}], "-", 
            RowBox[{"s121", " ", "s122"}], "-", 
            RowBox[{"s211", " ", "s212"}], "-", 
            RowBox[{"s221", " ", "s222"}], "-", 
            RowBox[{"s311", " ", "s312"}], "-", 
            RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ", 
       "v4x"}], "+", 
      RowBox[{"t", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r112", "2"], "+", 
            SuperscriptBox["r122", "2"]}], ")"}], " ", "v1x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r212", "2"], "+", 
            SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r312", "2"], "+", 
            SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r112", "2"], "+", 
                SuperscriptBox["r122", "2"]}], ")"}]}], " ", "v1x"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["s112", "2"], "+", 
               SuperscriptBox["s122", "2"]}], ")"}], " ", "v1x"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r212", "2"], "+", 
               SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["s212", "2"], "+", 
               SuperscriptBox["s222", "2"]}], ")"}], " ", "v2x"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r312", "2"], "+", 
               SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["s312", "2"], "+", 
               SuperscriptBox["s322", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["r112", "2"]}], "-", 
            SuperscriptBox["r122", "2"], "-", 
            SuperscriptBox["r212", "2"], "-", 
            SuperscriptBox["r222", "2"], "-", 
            SuperscriptBox["r312", "2"], "-", 
            SuperscriptBox["r322", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["r112", "2"], "+", 
               SuperscriptBox["r122", "2"], "+", 
               SuperscriptBox["r212", "2"], "+", 
               SuperscriptBox["r222", "2"], "+", 
               SuperscriptBox["r312", "2"], "+", 
               SuperscriptBox["r322", "2"], "-", 
               SuperscriptBox["s112", "2"], "-", 
               SuperscriptBox["s122", "2"], "-", 
               SuperscriptBox["s212", "2"], "-", 
               SuperscriptBox["s222", "2"], "-", 
               SuperscriptBox["s312", "2"], "-", 
               SuperscriptBox["s322", "2"]}], ")"}], " ", "t"}]}], ")"}], " ",
           "v4x"}]}], ")"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.79243601129778*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"6e494cbb-d06c-46fa-a171-8ee8c6cd07c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["polynomial"], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"3cb88bd5-d153-411d-a55d-80d85c83c61e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r111", "2"], "+", 
       SuperscriptBox["r121", "2"]}], ")"}], " ", "v1x"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r211", "2"], "+", 
       SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r311", "2"], "+", 
       SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r111", "2"], "+", 
           SuperscriptBox["r121", "2"]}], ")"}]}], " ", "v1x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s111", "2"], "+", 
          SuperscriptBox["s121", "2"]}], ")"}], " ", "v1x"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r211", "2"], "+", 
          SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s211", "2"], "+", 
          SuperscriptBox["s221", "2"]}], ")"}], " ", "v2x"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r311", "2"], "+", 
          SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s311", "2"], "+", 
          SuperscriptBox["s321", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}], "+", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["r111", "2"], "-", 
       SuperscriptBox["r121", "2"], "-", 
       SuperscriptBox["r211", "2"], "-", 
       SuperscriptBox["r221", "2"], "-", 
       SuperscriptBox["r311", "2"], "-", 
       SuperscriptBox["r321", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r111", "2"], "+", 
          SuperscriptBox["r121", "2"], "+", 
          SuperscriptBox["r211", "2"], "+", 
          SuperscriptBox["r221", "2"], "+", 
          SuperscriptBox["r311", "2"], "+", 
          SuperscriptBox["r321", "2"], "-", 
          SuperscriptBox["s111", "2"], "-", 
          SuperscriptBox["s121", "2"], "-", 
          SuperscriptBox["s211", "2"], "-", 
          SuperscriptBox["s221", "2"], "-", 
          SuperscriptBox["s311", "2"], "-", 
          SuperscriptBox["s321", "2"]}], ")"}], " ", "t"}]}], ")"}], " ", 
     "v4x"}], "+", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r111", " ", "r112"}], "+", 
          RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r211", " ", "r212"}], "+", 
          RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r311", " ", "r312"}], "+", 
          RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r111", " ", "r112"}], "+", 
              RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s111", " ", "s112"}], "+", 
             RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r211", " ", "r212"}], "+", 
             RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s211", " ", "s212"}], "+", 
             RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r311", " ", "r312"}], "+", 
             RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s311", " ", "s312"}], "+", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "r111"}], " ", "r112"}], "-", 
          RowBox[{"r121", " ", "r122"}], "-", 
          RowBox[{"r211", " ", "r212"}], "-", 
          RowBox[{"r221", " ", "r222"}], "-", 
          RowBox[{"r311", " ", "r312"}], "-", 
          RowBox[{"r321", " ", "r322"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r111", " ", "r112"}], "+", 
             RowBox[{"r121", " ", "r122"}], "+", 
             RowBox[{"r211", " ", "r212"}], "+", 
             RowBox[{"r221", " ", "r222"}], "+", 
             RowBox[{"r311", " ", "r312"}], "+", 
             RowBox[{"r321", " ", "r322"}], "-", 
             RowBox[{"s111", " ", "s112"}], "-", 
             RowBox[{"s121", " ", "s122"}], "-", 
             RowBox[{"s211", " ", "s212"}], "-", 
             RowBox[{"s221", " ", "s222"}], "-", 
             RowBox[{"s311", " ", "s312"}], "-", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ",
         "v4x"}]}], ")"}]}], "+", 
    RowBox[{"t", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r111", " ", "r112"}], "+", 
          RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "v1x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r211", " ", "r212"}], "+", 
          RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r311", " ", "r312"}], "+", 
          RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r111", " ", "r112"}], "+", 
              RowBox[{"r121", " ", "r122"}]}], ")"}]}], " ", "v1x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s111", " ", "s112"}], "+", 
             RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r211", " ", "r212"}], "+", 
             RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "v2x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s211", " ", "s212"}], "+", 
             RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r311", " ", "r312"}], "+", 
             RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "v3x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"s311", " ", "s312"}], "+", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "r111"}], " ", "r112"}], "-", 
          RowBox[{"r121", " ", "r122"}], "-", 
          RowBox[{"r211", " ", "r212"}], "-", 
          RowBox[{"r221", " ", "r222"}], "-", 
          RowBox[{"r311", " ", "r312"}], "-", 
          RowBox[{"r321", " ", "r322"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r111", " ", "r112"}], "+", 
             RowBox[{"r121", " ", "r122"}], "+", 
             RowBox[{"r211", " ", "r212"}], "+", 
             RowBox[{"r221", " ", "r222"}], "+", 
             RowBox[{"r311", " ", "r312"}], "+", 
             RowBox[{"r321", " ", "r322"}], "-", 
             RowBox[{"s111", " ", "s112"}], "-", 
             RowBox[{"s121", " ", "s122"}], "-", 
             RowBox[{"s211", " ", "s212"}], "-", 
             RowBox[{"s221", " ", "s222"}], "-", 
             RowBox[{"s311", " ", "s312"}], "-", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ",
         "v4x"}], "+", 
       RowBox[{"t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r112", "2"], "+", 
             SuperscriptBox["r122", "2"]}], ")"}], " ", "v1x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r212", "2"], "+", 
             SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r312", "2"], "+", 
             SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["r112", "2"], "+", 
                 SuperscriptBox["r122", "2"]}], ")"}]}], " ", "v1x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["s112", "2"], "+", 
                SuperscriptBox["s122", "2"]}], ")"}], " ", "v1x"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r212", "2"], "+", 
                SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["s212", "2"], "+", 
                SuperscriptBox["s222", "2"]}], ")"}], " ", "v2x"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r312", "2"], "+", 
                SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["s312", "2"], "+", 
                SuperscriptBox["s322", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}],
           "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["r112", "2"]}], "-", 
             SuperscriptBox["r122", "2"], "-", 
             SuperscriptBox["r212", "2"], "-", 
             SuperscriptBox["r222", "2"], "-", 
             SuperscriptBox["r312", "2"], "-", 
             SuperscriptBox["r322", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["r112", "2"], "+", 
                SuperscriptBox["r122", "2"], "+", 
                SuperscriptBox["r212", "2"], "+", 
                SuperscriptBox["r222", "2"], "+", 
                SuperscriptBox["r312", "2"], "+", 
                SuperscriptBox["r322", "2"], "-", 
                SuperscriptBox["s112", "2"], "-", 
                SuperscriptBox["s122", "2"], "-", 
                SuperscriptBox["s212", "2"], "-", 
                SuperscriptBox["s222", "2"], "-", 
                SuperscriptBox["s312", "2"], "-", 
                SuperscriptBox["s322", "2"]}], ")"}], " ", "t"}]}], ")"}], 
           " ", "v4x"}]}], ")"}]}]}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.792435930958682*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"8ece111e-1671-4b0b-8022-ad3d3d476c07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"polynomial", "=", 
  RowBox[{"polynomial", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.79243595475986*^9, 3.792435992531741*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"0609179e-ebea-43cc-bcc9-7856a7ca1904"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"List\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"",2,196,28,22751427562488358306,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.792435955292807*^9, 3.792435993207946*^9},
 CellLabel->
  "During evaluation of \
In[196]:=",ExpressionUUID->"4f3f48b9-9ae2-4687-8230-1fc788b488bd"],

Cell[BoxData[
 RowBox[{"List", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.792435952561226*^9, 3.792435955324943*^9}, 
   3.792435993216671*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"80b4c6f5-0571-4a89-99dc-1875b990dbd3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ax"], "Input",
 CellLabel->
  "In[169]:=",ExpressionUUID->"b5028d97-3553-4f2d-ac23-722718dd91c5"],

Cell[BoxData["ax"], "Output",
 CellChangeTimes->{3.792435916743598*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"5420832b-680c-4823-903f-0e5df8e8a235"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "^", "3"}], "+", 
    RowBox[{"5", "*", 
     RowBox[{"x", "^", "2"}]}], "+", 
    RowBox[{"7", "*", "x"}]}], ",", "x", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.7924358595571527`*^9, 3.792435879467577*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"63636b38-244a-48c7-bbea-6d8b85960cee"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.792435859993729*^9, 3.7924358797433863`*^9}},
 CellLabel->
  "Out[157]=",ExpressionUUID->"23c8ee17-fb99-464d-8da1-0280d8d4bbe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"polynomial", "//", "MatrixForm"}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.7924357317466593`*^9, 3.7924357454534807`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"962b8169-c06e-4544-bea4-40a3fd186c9b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r111", "2"], "+", 
          SuperscriptBox["r121", "2"]}], ")"}], " ", "v1x"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r111", "2"], "+", 
          SuperscriptBox["r121", "2"]}], ")"}], " ", "t", " ", "v1x"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r111", " ", "r112"}], "+", 
          RowBox[{"r121", " ", "r122"}]}], ")"}], " ", "t", " ", "v1x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s111", "2"], "+", 
          SuperscriptBox["s121", "2"]}], ")"}], " ", "t", " ", "v1x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r211", "2"], "+", 
          SuperscriptBox["r221", "2"]}], ")"}], " ", "v2x"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r211", "2"], "+", 
          SuperscriptBox["r221", "2"]}], ")"}], " ", "t", " ", "v2x"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r211", " ", "r212"}], "+", 
          RowBox[{"r221", " ", "r222"}]}], ")"}], " ", "t", " ", "v2x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s211", "2"], "+", 
          SuperscriptBox["s221", "2"]}], ")"}], " ", "t", " ", "v2x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r311", "2"], "+", 
          SuperscriptBox["r321", "2"]}], ")"}], " ", "v3x"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r311", "2"], "+", 
          SuperscriptBox["r321", "2"]}], ")"}], " ", "t", " ", "v3x"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r311", " ", "r312"}], "+", 
          RowBox[{"r321", " ", "r322"}]}], ")"}], " ", "t", " ", "v3x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["s311", "2"], "+", 
          SuperscriptBox["s321", "2"]}], ")"}], " ", "t", " ", "v3x"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["t", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r111"}], " ", "r112"}], "-", 
             RowBox[{"r121", " ", "r122"}], "+", 
             RowBox[{"s111", " ", "s112"}], "+", 
             RowBox[{"s121", " ", "s122"}]}], ")"}], " ", "v1x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r211"}], " ", "r212"}], "-", 
             RowBox[{"r221", " ", "r222"}], "+", 
             RowBox[{"s211", " ", "s212"}], "+", 
             RowBox[{"s221", " ", "s222"}]}], ")"}], " ", "v2x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r311"}], " ", "r312"}], "-", 
             RowBox[{"r321", " ", "r322"}], "+", 
             RowBox[{"s311", " ", "s312"}], "+", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "v3x"}]}], ")"}]}], 
       "+", "v4x", "-", 
       RowBox[{
        SuperscriptBox["r111", "2"], " ", "v4x"}], "-", 
       RowBox[{
        SuperscriptBox["r121", "2"], " ", "v4x"}], "-", 
       RowBox[{
        SuperscriptBox["r211", "2"], " ", "v4x"}], "-", 
       RowBox[{
        SuperscriptBox["r221", "2"], " ", "v4x"}], "-", 
       RowBox[{
        SuperscriptBox["r311", "2"], " ", "v4x"}], "-", 
       RowBox[{
        SuperscriptBox["r321", "2"], " ", "v4x"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r111", "2"], "+", 
          SuperscriptBox["r121", "2"], "+", 
          SuperscriptBox["r211", "2"], "+", 
          SuperscriptBox["r221", "2"], "+", 
          SuperscriptBox["r311", "2"], "+", 
          SuperscriptBox["r321", "2"], "-", 
          SuperscriptBox["s111", "2"], "-", 
          SuperscriptBox["s121", "2"], "-", 
          SuperscriptBox["s211", "2"], "-", 
          SuperscriptBox["s221", "2"], "-", 
          SuperscriptBox["s311", "2"], "-", 
          SuperscriptBox["s321", "2"]}], ")"}], " ", "t", " ", "v4x"}], "+", 
       RowBox[{"2", " ", "t", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "r211"}], " ", "r212"}], "-", 
          RowBox[{"r221", " ", "r222"}], "-", 
          RowBox[{"r311", " ", "r312"}], "-", 
          RowBox[{"r321", " ", "r322"}], "+", 
          RowBox[{"r111", " ", "r112", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}]}], "+", 
          RowBox[{"r121", " ", "r122", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r211", " ", "r212"}], "+", 
             RowBox[{"r221", " ", "r222"}], "+", 
             RowBox[{"r311", " ", "r312"}], "+", 
             RowBox[{"r321", " ", "r322"}], "-", 
             RowBox[{"s111", " ", "s112"}], "-", 
             RowBox[{"s121", " ", "s122"}], "-", 
             RowBox[{"s211", " ", "s212"}], "-", 
             RowBox[{"s221", " ", "s222"}], "-", 
             RowBox[{"s311", " ", "s312"}], "-", 
             RowBox[{"s321", " ", "s322"}]}], ")"}], " ", "t"}]}], ")"}], " ",
         "v4x"}], "+", 
       RowBox[{
        SuperscriptBox["t", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r212", "2"], "+", 
             SuperscriptBox["r222", "2"]}], ")"}], " ", "v2x"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r312", "2"], "+", 
             SuperscriptBox["r322", "2"]}], ")"}], " ", "v3x"}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["s112", "2"], "+", 
                SuperscriptBox["s122", "2"]}], ")"}], " ", "v1x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r212", "2"]}], "-", 
                SuperscriptBox["r222", "2"], "+", 
                SuperscriptBox["s212", "2"], "+", 
                SuperscriptBox["s222", "2"]}], ")"}], " ", "v2x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r312", "2"]}], "-", 
                SuperscriptBox["r322", "2"], "+", 
                SuperscriptBox["s312", "2"], "+", 
                SuperscriptBox["s322", "2"]}], ")"}], " ", "v3x"}]}], ")"}]}],
           "-", 
          RowBox[{
           SuperscriptBox["r112", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"v1x", "-", "v4x"}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["r122", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"v1x", "-", "v4x"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r212", "2"], "+", 
             SuperscriptBox["r222", "2"], "+", 
             SuperscriptBox["r312", "2"], "+", 
             SuperscriptBox["r322", "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["r212", "2"]}], "-", 
                SuperscriptBox["r222", "2"], "-", 
                SuperscriptBox["r312", "2"], "-", 
                SuperscriptBox["r322", "2"], "+", 
                SuperscriptBox["s112", "2"], "+", 
                SuperscriptBox["s122", "2"], "+", 
                SuperscriptBox["s212", "2"], "+", 
                SuperscriptBox["s222", "2"], "+", 
                SuperscriptBox["s312", "2"], "+", 
                SuperscriptBox["s322", "2"]}], ")"}], " ", "t"}]}], ")"}], 
           " ", "v4x"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7924357338990088`*^9, 3.7924357580510197`*^9}},
 CellLabel->
  "Out[154]//MatrixForm=",ExpressionUUID->"d53792a7-92bc-4212-bdc3-\
64b1b3c0ca66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S4TS4", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.792435692870411*^9, 3.792435694004794*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"f509cb28-597b-45f0-be8d-065fc7345872"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       SuperscriptBox["s111", "2"], "-", 
       SuperscriptBox["s121", "2"], "-", 
       SuperscriptBox["s211", "2"], "-", 
       SuperscriptBox["s221", "2"], "-", 
       SuperscriptBox["s311", "2"], "-", 
       SuperscriptBox["s321", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "s111"}], " ", "s112"}], "-", 
       RowBox[{"s121", " ", "s122"}], "-", 
       RowBox[{"s211", " ", "s212"}], "-", 
       RowBox[{"s221", " ", "s222"}], "-", 
       RowBox[{"s311", " ", "s312"}], "-", 
       RowBox[{"s321", " ", "s322"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "s111"}], " ", "s112"}], "-", 
       RowBox[{"s121", " ", "s122"}], "-", 
       RowBox[{"s211", " ", "s212"}], "-", 
       RowBox[{"s221", " ", "s222"}], "-", 
       RowBox[{"s311", " ", "s312"}], "-", 
       RowBox[{"s321", " ", "s322"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["s112", "2"]}], "-", 
       SuperscriptBox["s122", "2"], "-", 
       SuperscriptBox["s212", "2"], "-", 
       SuperscriptBox["s222", "2"], "-", 
       SuperscriptBox["s312", "2"], "-", 
       SuperscriptBox["s322", "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792435318214007*^9, 3.792435344421031*^9}, {
  3.792435676143436*^9, 3.792435694707815*^9}},
 CellLabel->
  "Out[128]//MatrixForm=",ExpressionUUID->"928f2f5e-c7c8-47cd-ba11-\
96b5097d690a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "R1", "]"}], ".", "R1"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7924351936973763`*^9, 3.792435219172348*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"c18c4fc8-3217-46f1-8210-cd92577386cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["r111", "2"], "+", 
       SuperscriptBox["r121", "2"]}], 
      RowBox[{
       RowBox[{"r111", " ", "r112"}], "+", 
       RowBox[{"r121", " ", "r122"}]}]},
     {
      RowBox[{
       RowBox[{"r111", " ", "r112"}], "+", 
       RowBox[{"r121", " ", "r122"}]}], 
      RowBox[{
       SuperscriptBox["r112", "2"], "+", 
       SuperscriptBox["r122", "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792435195152657*^9, 3.792435219616151*^9}},
 CellLabel->
  "Out[55]//MatrixForm=",ExpressionUUID->"bed1a98c-19a1-42a1-810d-\
d99df04d3c28"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.792345408288003*^9, 3.7923454153608923`*^9}, {
  3.792345446608897*^9, 3.7923457215252867`*^9}, {3.7923457593421926`*^9, 
  3.792345796845405*^9}, {3.7923459810688963`*^9, 3.792346018699731*^9}, {
  3.79234628477134*^9, 
  3.792346315053383*^9}},ExpressionUUID->"5bafe042-ec7c-493e-9b3d-\
7a76b82f5804"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cost", "=", 
  RowBox[{
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {"x1", "x2", "x3", "x4"},
       {"y1", "y2", "y3", "y4"},
       {"z1", "z2", "z3", "z4"},
       {"1", "1", "1", "1"}
      }], ")"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.792358023706469*^9, 3.792358030341516*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"15b1d369-ef04-46e8-b21d-f68f53dccd40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2", " ", "y3", " ", "z1"}], "-", 
  RowBox[{"x2", " ", "y4", " ", "z1"}], "-", 
  RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
  RowBox[{"x1", " ", "y4", " ", "z2"}], "-", 
  RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
  RowBox[{"x1", " ", "y2", " ", "z3"}], "-", 
  RowBox[{"x1", " ", "y4", " ", "z3"}], "+", 
  RowBox[{"x2", " ", "y4", " ", "z3"}], "+", 
  RowBox[{"x4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"y2", " ", "z1"}], "-", 
     RowBox[{"y3", " ", "z1"}], "-", 
     RowBox[{"y1", " ", "z2"}], "+", 
     RowBox[{"y3", " ", "z2"}], "+", 
     RowBox[{"y1", " ", "z3"}], "-", 
     RowBox[{"y2", " ", "z3"}]}], ")"}]}], "+", 
  RowBox[{"x2", " ", "y1", " ", "z4"}], "-", 
  RowBox[{"x1", " ", "y2", " ", "z4"}], "+", 
  RowBox[{"x1", " ", "y3", " ", "z4"}], "-", 
  RowBox[{"x2", " ", "y3", " ", "z4"}], "+", 
  RowBox[{"x3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"y4", " ", "z1"}], "+", 
     RowBox[{"y1", " ", "z2"}], "-", 
     RowBox[{"y4", " ", "z2"}], "-", 
     RowBox[{"y1", " ", "z4"}], "+", 
     RowBox[{"y2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z1"}], "+", "z4"}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7923454165797987`*^9, {3.7923580252374907`*^9, 3.792358030996819*^9}},
 CellLabel->"Out[2]=",ExpressionUUID->"9872eaed-b5ec-47fa-ad34-3c1538549cb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "-", 
      RowBox[{"2", " ", "y"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}]}], "\[LessEqual]", "1"}], ",", " ", 
     RowBox[{"x", "\[GreaterEqual]", 
      RowBox[{"-", "0.3"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.792345877854596*^9, 3.7923459737521048`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0a056487-b85d-4cf1-93f2-da941f58a76d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.2078788980984485`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"-", "0.30000095847930364`"}]}], ",", 
     RowBox[{"y", "\[Rule]", "0.9539389698095725`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.792345884646831*^9, 3.792345974086204*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"2102046e-35b4-43af-b144-26275d6aea1e"]
}, Open  ]],

Cell[BoxData[\
"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW"], "Input",
 CellChangeTimes->{{3.792345661621071*^9, 
  3.792345669606461*^9}},ExpressionUUID->"60c1c749-20f3-4fba-8a2f-\
f5f6cf5a88c5"],

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cost", ",", 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"ax"},
          {"ay"},
          {"az"},
          {"bx"},
          {"by"},
          {"bz"},
          {GridBox[{
             {"cx"},
             {"cy"},
             {"cz"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]},
          {"dx"},
          {"dy"},
          {"dz"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], "\[Equal]", 
      RowBox[{"a", ".", 
       RowBox[{"(", GridBox[{
          {"x1"},
          {"y1"},
          {"z1"},
          {"x2"},
          {"y2"},
          {"z2"},
          {"x3"},
          {"y3"},
          {"z3"},
          {"x4"},
          {"y4"},
          {"z4"}
         }], ")"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", 
     ",", "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4", ",", "l1a", ",", 
     "l2a", ",", "l3a", ",", "l1b", ",", "l2b", ",", "l3b", ",", "l1c", ",", 
     "l2ac", ",", "l3c", ",", "l1d", ",", "l2d", ",", "l3d"}], "}"}]}], 
  "]"}]], "Input",ExpressionUUID->"881e1115-9720-46fe-90d2-80e0854c0ea8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", ".", 
   RowBox[{"(", GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {"x3"},
      {"y3"},
      {"z3"},
      {"x4"},
      {"y4"},
      {"z4"}
     }], ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.79234526092447*^9, {3.7923453670361633`*^9, 3.792345368480074*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"92284809-2446-4e45-8db3-b5916b09c6dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"l1a", " ", "x1"}], "+", 
       RowBox[{"l2a", " ", "x2"}], "+", 
       RowBox[{"l3a", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1a", " ", "y1"}], "+", 
       RowBox[{"l2a", " ", "y2"}], "+", 
       RowBox[{"l3a", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1a", " ", "z1"}], "+", 
       RowBox[{"l2a", " ", "z2"}], "+", 
       RowBox[{"l3a", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "x1"}], "+", 
       RowBox[{"l2b", " ", "x2"}], "+", 
       RowBox[{"l3b", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "y1"}], "+", 
       RowBox[{"l2b", " ", "y2"}], "+", 
       RowBox[{"l3b", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "z1"}], "+", 
       RowBox[{"l2b", " ", "z2"}], "+", 
       RowBox[{"l3b", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "x1"}], "+", 
       RowBox[{"l2c", " ", "x2"}], "+", 
       RowBox[{"l3c", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "y1"}], "+", 
       RowBox[{"l2c", " ", "y2"}], "+", 
       RowBox[{"l3c", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "z1"}], "+", 
       RowBox[{"l2c", " ", "z2"}], "+", 
       RowBox[{"l3c", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "x1"}], "+", 
       RowBox[{"l2d", " ", "x2"}], "+", 
       RowBox[{"l3d", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "y1"}], "+", 
       RowBox[{"l2d", " ", "y2"}], "+", 
       RowBox[{"l3d", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "z1"}], "+", 
       RowBox[{"l2d", " ", "z2"}], "+", 
       RowBox[{"l3d", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "z4"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792345243637063*^9, 3.792345261453817*^9}, 
   3.792345368890048*^9},
 CellLabel->
  "Out[164]//MatrixForm=",ExpressionUUID->"9b6a1d26-869e-4a5c-9bc6-\
07335a32cbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"a", ".", 
   RowBox[{"(", GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {"x3"},
      {"y3"},
      {"z3"},
      {"x4"},
      {"y4"},
      {"z4"}
     }], ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.792345192170848*^9, 3.792345193291306*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"da5f068c-5ea9-41f0-8368-95889dbe524d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"l1a", " ", "x1"}], "+", 
       RowBox[{"l2a", " ", "x2"}], "+", 
       RowBox[{"l3a", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1a", " ", "y1"}], "+", 
       RowBox[{"l2a", " ", "y2"}], "+", 
       RowBox[{"l3a", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1a", " ", "z1"}], "+", 
       RowBox[{"l2a", " ", "z2"}], "+", 
       RowBox[{"l3a", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "x1"}], "+", 
       RowBox[{"l2b", " ", "x2"}], "+", 
       RowBox[{"l3b", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "y1"}], "+", 
       RowBox[{"l2b", " ", "y2"}], "+", 
       RowBox[{"l3b", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1b", " ", "z1"}], "+", 
       RowBox[{"l2b", " ", "z2"}], "+", 
       RowBox[{"l3b", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "x1"}], "+", 
       RowBox[{"l2c", " ", "x2"}], "+", 
       RowBox[{"l3c", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "y1"}], "+", 
       RowBox[{"l2c", " ", "y2"}], "+", 
       RowBox[{"l3c", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1c", " ", "z1"}], "+", 
       RowBox[{"l2c", " ", "z2"}], "+", 
       RowBox[{"l3c", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
        "z4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "x1"}], "+", 
       RowBox[{"l2d", " ", "x2"}], "+", 
       RowBox[{"l3d", " ", "x3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "x4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "y1"}], "+", 
       RowBox[{"l2d", " ", "y2"}], "+", 
       RowBox[{"l3d", " ", "y3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "y4"}]}]},
     {
      RowBox[{
       RowBox[{"l1d", " ", "z1"}], "+", 
       RowBox[{"l2d", " ", "z2"}], "+", 
       RowBox[{"l3d", " ", "z3"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
        "z4"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792345127921439*^9, 3.792345133488387*^9}, {
  3.7923451713136253`*^9, 3.792345194136569*^9}},
 CellLabel->
  "Out[156]//MatrixForm=",ExpressionUUID->"55126a11-3c26-438a-ab9f-\
4de00935cf47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"ax"},
      {"ay"},
      {"az"},
      {"bx"},
      {"by"},
      {"bz"},
      {GridBox[{
         {"cx"},
         {"cy"},
         {"cz"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}]},
      {"dx"},
      {"dy"},
      {"dz"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}], "\[Equal]", 
  RowBox[{"a", ".", 
   RowBox[{"(", GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {"x3"},
      {"y3"},
      {"z3"},
      {"x4"},
      {"y4"},
      {"z4"}
     }], ")"}]}]}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"e7221398-5eb4-4782-8d8d-cb98085d42a0"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.7923451025233803`*^9, 3.79234511656528*^9}},
 CellLabel->
  "Out[140]=",ExpressionUUID->"fe393116-1722-4b7e-82a9-4bec41fef86a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", ".", 
  RowBox[{"(", GridBox[{
     {"x1"},
     {"y1"},
     {"z1"},
     {"x2"},
     {"y2"},
     {"z2"},
     {"x3"},
     {"y3"},
     {"z3"},
     {"x4"},
     {"y4"},
     {"z4"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.792345055788423*^9, 3.792345055976781*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"99c7b09f-2d1b-45f2-96dc-d9da3609fdf1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1a", " ", "x1"}], "+", 
     RowBox[{"l2a", " ", "x2"}], "+", 
     RowBox[{"l3a", " ", "x3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
      "x4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1a", " ", "y1"}], "+", 
     RowBox[{"l2a", " ", "y2"}], "+", 
     RowBox[{"l3a", " ", "y3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
      "y4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1a", " ", "z1"}], "+", 
     RowBox[{"l2a", " ", "z2"}], "+", 
     RowBox[{"l3a", " ", "z3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ")"}], " ", 
      "z4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1b", " ", "x1"}], "+", 
     RowBox[{"l2b", " ", "x2"}], "+", 
     RowBox[{"l3b", " ", "x3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
      "x4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1b", " ", "y1"}], "+", 
     RowBox[{"l2b", " ", "y2"}], "+", 
     RowBox[{"l3b", " ", "y3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
      "y4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1b", " ", "z1"}], "+", 
     RowBox[{"l2b", " ", "z2"}], "+", 
     RowBox[{"l3b", " ", "z3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ")"}], " ", 
      "z4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1c", " ", "x1"}], "+", 
     RowBox[{"l2c", " ", "x2"}], "+", 
     RowBox[{"l3c", " ", "x3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
      "x4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1c", " ", "y1"}], "+", 
     RowBox[{"l2c", " ", "y2"}], "+", 
     RowBox[{"l3c", " ", "y3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
      "y4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1c", " ", "z1"}], "+", 
     RowBox[{"l2c", " ", "z2"}], "+", 
     RowBox[{"l3c", " ", "z3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ")"}], " ", 
      "z4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1d", " ", "x1"}], "+", 
     RowBox[{"l2d", " ", "x2"}], "+", 
     RowBox[{"l3d", " ", "x3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
      "x4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1d", " ", "y1"}], "+", 
     RowBox[{"l2d", " ", "y2"}], "+", 
     RowBox[{"l3d", " ", "y3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
      "y4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l1d", " ", "z1"}], "+", 
     RowBox[{"l2d", " ", "z2"}], "+", 
     RowBox[{"l3d", " ", "z3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ")"}], " ", 
      "z4"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7923450407366457`*^9, 3.792345056224811*^9}},
 CellLabel->
  "Out[135]=",ExpressionUUID->"7851cc40-62a8-43da-b8a2-0d16494a6ef1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    }], ")"}], ".", 
  RowBox[{"(", GridBox[{
     {"x1"},
     {"y1"},
     {"z1"},
     {"x2"},
     {"y2"},
     {"z2"},
     {"x3"},
     {"y3"},
     {"z3"},
     {"x4"},
     {"y4"},
     {"4"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.792344830809114*^9, 3.7923450288327713`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"37e73f82-c8a5-494d-a2fe-21e8e052314c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.792344836468095*^9, 3.792344903274338*^9, {3.7923449335121813`*^9, 
   3.792344991101778*^9}, 3.792345029997138*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"f88d98f0-3b73-4822-991c-4dcc1210c917"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    }], ")"}], ".", 
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {GridBox[{
         {"x3"},
         {"y3"},
         {"z3"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}]},
      {"x4"},
      {"y4"},
      {"z4"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}]}]], "Input",
 CellChangeTimes->{{3.792344704433663*^9, 3.792344775678344*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"59261354-aa49-4562-af2a-c27e2e2d8011"],

Cell[BoxData[
 TemplateBox[{
  "Dot","rect","\"Nonrectangular tensor encountered.\"",2,120,19,
   22750748451378006459,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.792344682701028*^9, 3.792344711257584*^9}, {
  3.7923447661061563`*^9, 3.792344776109314*^9}},
 CellLabel->
  "During evaluation of \
In[120]:=",ExpressionUUID->"9e7b4205-66e5-48bb-8e76-01fe80d9aa22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x3", "}"}], ",", 
      RowBox[{"{", "y3", "}"}], ",", 
      RowBox[{"{", "z3", "}"}]}], "}"}], ",", "x4", ",", "y4", ",", "z4"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{{3.792344682713173*^9, 3.792344711268053*^9}, {
  3.792344766132655*^9, 3.7923447761167994`*^9}},
 CellLabel->
  "Out[120]=",ExpressionUUID->"17922105-c391-42f5-b5d1-23e684316499"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", ".", 
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {GridBox[{
         {"x3"},
         {"y3"},
         {"z3"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}]},
      {"x4"},
      {"y4"},
      {"z4"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}]}]], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"b569b52f-2f1a-4e26-b12a-7ba8516291d0"],

Cell[BoxData[
 TemplateBox[{
  "Dot","rect","\"Nonrectangular tensor encountered.\"",2,113,12,
   22750748451378006459,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.792344692512413*^9},
 CellLabel->
  "During evaluation of \
In[113]:=",ExpressionUUID->"6de4dc04-18e6-4842-bca0-7f7ce8e0fb60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",", "0", ",", "l3a", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",", "0", ",",
       "l3a", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",",
       "0", ",", "l3a", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",", "0", ",", "l3b", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",", "0", ",",
       "l3b", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",",
       "0", ",", "l3b", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",", "0", ",", "l3c", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",", "0", ",",
       "l3c", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",",
       "0", ",", "l3c", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",", "0", ",", "l3d", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",", "0", ",",
       "l3d", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",",
       "0", ",", "l3d", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}]}], "}"}]}], "}"}], 
  ".", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x3", "}"}], ",", 
      RowBox[{"{", "y3", "}"}], ",", 
      RowBox[{"{", "z3", "}"}]}], "}"}], ",", "x4", ",", "y4", ",", "z4"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{3.792344692520194*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"23c55b47-94b4-4861-8093-f279f4e2c240"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", ".", 
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"x1"},
      {"y1"},
      {"z1"},
      {"x2"},
      {"y2"},
      {"z2"},
      {GridBox[{
         {"x3"},
         {"y3"},
         {"z3"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}]},
      {"x4"},
      {"y4"},
      {"z4"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}]}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"d2382b20-d790-43b1-a355-571532eeb682"],

Cell[BoxData[
 TemplateBox[{
  "Dot","rect","\"Nonrectangular tensor encountered.\"",2,108,10,
   22750748451378006459,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.792344396564074*^9, 3.792344404711247*^9}, 
   3.7923445149164352`*^9, {3.792344564182419*^9, 3.792344581947785*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"b233e1a9-f422-4afe-aef8-653a3bf144a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",", "0", ",", "l3a", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",", "0", ",",
       "l3a", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1a", ",", "0", ",", "0", ",", "l2a", ",", "0", ",",
       "0", ",", "l3a", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1a", "-", "l2a", "-", "l3a"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",", "0", ",", "l3b", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",", "0", ",",
       "l3b", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1b", ",", "0", ",", "0", ",", "l2b", ",", "0", ",",
       "0", ",", "l3b", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1b", "-", "l2b", "-", "l3b"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",", "0", ",", "l3c", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",", "0", ",",
       "l3c", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1c", ",", "0", ",", "0", ",", "l2c", ",", "0", ",",
       "0", ",", "l3c", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1c", "-", "l2c", "-", "l3c"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",", "0", ",", "l3d", 
      ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ",", "0", ",", "0"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",", "0", ",",
       "l3d", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "l1d", ",", "0", ",", "0", ",", "l2d", ",", "0", ",",
       "0", ",", "l3d", ",", "0", ",", "0", ",", 
      RowBox[{"1", "-", "l1d", "-", "l2d", "-", "l3d"}]}], "}"}]}], "}"}], 
  ".", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "x3", "}"}], ",", 
      RowBox[{"{", "y3", "}"}], ",", 
      RowBox[{"{", "z3", "}"}]}], "}"}], ",", "x4", ",", "y4", ",", "z4"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{{3.7923443965714293`*^9, 3.792344404720051*^9}, 
   3.792344514924561*^9, {3.792344564190646*^9, 3.792344581958046*^9}},
 CellLabel->
  "Out[108]=",ExpressionUUID->"cdd93294-a70b-485a-af80-e64289856e9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "A", "]"}], ".", 
   RowBox[{"(", "\[NoBreak]", 
    TagBox[GridBox[{
       {"x1"},
       {"y1"},
       {"z1"},
       {"x2"},
       {"y2"},
       {"z2"},
       {GridBox[{
          {"x3"},
          {"y3"},
          {"z3"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}]},
       {"x4"},
       {"y4"},
       {"z4"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     Column], "\[NoBreak]", ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.792343710907057*^9, 3.7923437250718927`*^9}, {
   3.792343845441725*^9, 3.792343946045659*^9}, 3.7923439944986258`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"8541213f-c00a-4595-8250-d4bce1ce1d5f"],

Cell[BoxData[
 TemplateBox[{
  "Dot","rect","\"Nonrectangular tensor encountered.\"",2,73,3,
   22750748451378006459,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.792343968094652*^9, 3.792343995168714*^9}, {
  3.792344255065043*^9, 
  3.792344255700706*^9}},ExpressionUUID->"dd3c1e7a-b178-458f-9c53-\
1c8d02196f48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"b", "*", "c", "*", " ", 
     RowBox[{"x", "^", "2"}]}], "-", 
    RowBox[{"a", "*", " ", "x"}], "+", "5"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.792344209450719*^9, 3.7923442410536337`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"f6ba9323-fe0d-43ca-8999-497f45e0e33a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {"5", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "\[Equal]", "0"}], "&&", 
             RowBox[{"a", "\[Equal]", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", ">", "0"}], "&&", 
             RowBox[{"a", "\[Equal]", "0"}], "&&", 
             RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", ">", "0"}], "&&", 
             RowBox[{"a", "\[Equal]", "0"}], "&&", 
             RowBox[{"b", ">", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "<", "0"}], "&&", 
             RowBox[{"a", "\[Equal]", "0"}], "&&", 
             RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "<", "0"}], "&&", 
             RowBox[{"a", "\[Equal]", "0"}], "&&", 
             RowBox[{"b", "<", "0"}]}], ")"}]}]},
         {
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"20", " ", "b", " ", "c"}]}], 
           RowBox[{"4", " ", "b", " ", "c"}]], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", ">", "0"}], "&&", 
             RowBox[{"a", ">", "0"}], "&&", 
             RowBox[{"b", ">", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", ">", "0"}], "&&", 
             RowBox[{"a", "<", "0"}], "&&", 
             RowBox[{"b", ">", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "<", "0"}], "&&", 
             RowBox[{"a", ">", "0"}], "&&", 
             RowBox[{"b", "<", "0"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", "<", "0"}], "&&", 
             RowBox[{"a", "<", "0"}], "&&", 
             RowBox[{"b", "<", "0"}]}], ")"}]}]},
         {
          RowBox[{"-", "\[Infinity]"}], 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True], ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            FractionBox["a", 
             RowBox[{"2", " ", "b", " ", "c"}]], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", ">", "0"}], "&&", 
               RowBox[{"a", ">", "0"}], "&&", 
               RowBox[{"b", ">", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", ">", "0"}], "&&", 
               RowBox[{"a", "<", "0"}], "&&", 
               RowBox[{"b", ">", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "<", "0"}], "&&", 
               RowBox[{"a", ">", "0"}], "&&", 
               RowBox[{"b", "<", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "<", "0"}], "&&", 
               RowBox[{"a", "<", "0"}], "&&", 
               RowBox[{"b", "<", "0"}]}], ")"}]}]},
           {"0", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "\[Equal]", "0"}], "&&", 
               RowBox[{"a", "\[Equal]", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", ">", "0"}], "&&", 
               RowBox[{"a", "\[Equal]", "0"}], "&&", 
               RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", ">", "0"}], "&&", 
               RowBox[{"a", "\[Equal]", "0"}], "&&", 
               RowBox[{"b", ">", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "<", "0"}], "&&", 
               RowBox[{"a", "\[Equal]", "0"}], "&&", 
               RowBox[{"b", "\[Equal]", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "<", "0"}], "&&", 
               RowBox[{"a", "\[Equal]", "0"}], "&&", 
               RowBox[{"b", "<", "0"}]}], ")"}]}]},
           {"Indeterminate", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}},
          Selectable->True]}
       },
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False,
      StripWrapperBoxes->True]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.792344212926543*^9, 3.792344241346561*^9}},
 CellLabel->"Out[78]=",ExpressionUUID->"2c727130-ddd6-427a-a986-b8cf33e6713d"]
}, Open  ]]
},
WindowSize->{2495, 1416},
WindowMargins->{{1985, Automatic}, {Automatic, -117}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 152, 3, 36, "Input",ExpressionUUID->"13910d4b-4b3c-492e-8f2a-42430f35133d"],
Cell[CellGroupData[{
Cell[735, 27, 1674, 52, 229, "Input",ExpressionUUID->"c5a8e35f-d462-4bbf-a20c-9bad1df73599"],
Cell[2412, 81, 537, 17, 60, "Output",ExpressionUUID->"c41995ca-4514-4d5d-bf98-a624bbfaaeff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2986, 103, 1728, 53, 230, "Input",ExpressionUUID->"1c6177d8-fc59-4b0d-b628-9931ff1d60c4"],
Cell[4717, 158, 628, 17, 60, "Output",ExpressionUUID->"5a0322ec-5fc1-4bf8-824c-7f01d95f700f"],
Cell[5348, 177, 1162, 36, 64, "Output",ExpressionUUID->"5973b0b0-db90-4f03-a20c-4f7bf5dbd2a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6547, 218, 2139, 68, 394, "Input",ExpressionUUID->"3382e6b4-2a7e-4f20-8028-b0ad844e92b0"],
Cell[8689, 288, 314, 7, 57, "Output",ExpressionUUID->"32aab53a-71f5-4653-9f45-ee985063780d"],
Cell[9006, 297, 297, 6, 57, "Output",ExpressionUUID->"e81619a3-1685-418c-9192-fa3ab1bd3825"],
Cell[9306, 305, 247, 4, 40, "Output",ExpressionUUID->"e86870f2-ab64-4a99-a89b-edfdbf103ef0"],
Cell[9556, 311, 494, 14, 60, "Output",ExpressionUUID->"d511aa40-18e8-46ee-af4f-45b51487cff4"],
Cell[10053, 327, 582, 17, 76, "Output",ExpressionUUID->"98b76b63-ae4b-4010-a883-31be18416e7c"],
Cell[10638, 346, 538, 16, 60, "Output",ExpressionUUID->"7e9fc5f9-05cd-4c31-8d6f-4e9e25d41eb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11213, 367, 2557, 65, 262, "Input",ExpressionUUID->"7274f37f-2dd0-4801-b976-63d19197850c"],
Cell[13773, 434, 748, 17, 40, "Output",ExpressionUUID->"b492d0dd-ff8e-487e-a29c-1c5ab377f8f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14558, 456, 1378, 43, 207, "Input",ExpressionUUID->"88069599-2df9-4f93-9f40-006ed9c0762d"],
Cell[15939, 501, 895, 28, 64, "Output",ExpressionUUID->"0cd1f7a9-71c8-423d-a64f-9b7bb07b863c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16871, 534, 1738, 51, 235, "Input",ExpressionUUID->"0b4c8741-1730-4cb0-acbf-aee85a17b195"],
Cell[18612, 587, 320, 5, 40, "Output",ExpressionUUID->"0193189b-9019-4ce7-868a-24e32f9dca8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18969, 597, 4425, 118, 424, "Input",ExpressionUUID->"d5d0d391-d579-4dc1-ac57-87214064f668"],
Cell[23397, 717, 534, 7, 40, "Output",ExpressionUUID->"3fea5026-982b-445b-9ac3-570e19c1e78e"],
Cell[23934, 726, 1127, 29, 93, "Output",ExpressionUUID->"9ecfc488-f43b-41fd-b71a-2895c9da3bd5"],
Cell[25064, 757, 1324, 36, 93, "Output",ExpressionUUID->"66dcb714-b2af-487a-b0a1-47f6f9e7f69f"],
Cell[26391, 795, 736, 14, 40, "Output",ExpressionUUID->"486a55b2-bf8b-4cde-b3dd-1822a9b77719"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27164, 814, 304, 8, 36, "Input",ExpressionUUID->"2c0987ad-85eb-48f1-895a-1b57b386e9b0"],
Cell[27471, 824, 1612, 51, 161, "Output",ExpressionUUID->"98a4bb52-9889-4611-8c35-bac8cfb746e3"]
}, Open  ]],
Cell[29098, 878, 131, 1, 36, "Input",ExpressionUUID->"599708d3-08ef-42cb-92b1-eeb21aaa26f8"],
Cell[29232, 881, 1650, 51, 125, "Input",ExpressionUUID->"fb728b87-753c-4f51-bf54-bffef4c25d00"],
Cell[30885, 934, 2596, 74, 184, "Input",ExpressionUUID->"4eced7a3-b604-4b4c-98de-204ff0d90cdf"],
Cell[33484, 1010, 8480, 218, 861, "Input",ExpressionUUID->"b0fc30df-a69e-4b44-b23c-ede9719acd02"],
Cell[41967, 1230, 12401, 378, 1000, "Input",ExpressionUUID->"63c6debf-21ad-47c6-9f59-477455df2d4b"],
Cell[54371, 1610, 179, 3, 36, "Input",ExpressionUUID->"a8d1777d-498c-4af3-82eb-736f74712c3b"],
Cell[54553, 1615, 1195, 31, 206, "Input",ExpressionUUID->"0ad9f8f6-12ec-4454-850d-d84ec7303948"],
Cell[55751, 1648, 886, 17, 64, "Input",ExpressionUUID->"d8037bad-59ac-48e7-9dc4-5c1de60656f2"],
Cell[CellGroupData[{
Cell[56662, 1669, 1429, 42, 215, "Input",ExpressionUUID->"52a815ea-18b2-4465-8553-bf583ed6d2d2"],
Cell[58094, 1713, 196, 4, 40, "Output",ExpressionUUID->"6f78d8c3-d8f4-4ef9-a70b-8f0105ae833b"],
Cell[58293, 1719, 279, 7, 40, "Output",ExpressionUUID->"20b2b14a-244f-400c-97c9-8fcab7f09c6a"],
Cell[58575, 1728, 305, 8, 40, "Output",ExpressionUUID->"28f583e8-d345-4702-8fcb-69cbb5f26689"],
Cell[58883, 1738, 241, 6, 40, "Output",ExpressionUUID->"ef3573f7-8e58-4a47-8c37-0a6caf2fc9c3"]
}, Open  ]],
Cell[59139, 1747, 606, 14, 91, "Input",ExpressionUUID->"9b7f3a75-90ee-47da-89bd-0e40e81c61bd"],
Cell[CellGroupData[{
Cell[59770, 1765, 177, 3, 36, "Input",ExpressionUUID->"ffb16e15-22fe-4df9-8071-0d2aa714956d"],
Cell[59950, 1770, 1689, 53, 40, "Output",ExpressionUUID->"19647d73-6a2c-4d64-914e-a4dbb90c8c2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61676, 1828, 119, 2, 36, "Input",ExpressionUUID->"f514e9f4-82cf-4b1e-9bce-2b94a2fad63e"],
Cell[61798, 1832, 10967, 315, 240, "Output",ExpressionUUID->"cf3d22b7-2c4a-49db-b0d1-070295f21364"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72802, 2152, 119, 2, 36, "Input",ExpressionUUID->"9c75bd1a-2866-4f18-94dd-1e27743465eb"],
Cell[72924, 2156, 11300, 316, 240, "Output",ExpressionUUID->"6e494cbb-d06c-46fa-a171-8ee8c6cd07c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84261, 2477, 119, 2, 36, "Input",ExpressionUUID->"3cb88bd5-d153-411d-a55d-80d85c83c61e"],
Cell[84383, 2481, 11641, 318, 240, "Output",ExpressionUUID->"8ece111e-1671-4b0b-8022-ad3d3d476c07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96061, 2804, 267, 6, 36, "Input",ExpressionUUID->"0609179e-ebea-43cc-bcc9-7856a7ca1904"],
Cell[96331, 2812, 468, 10, 25, "Message",ExpressionUUID->"4f3f48b9-9ae2-4687-8230-1fc788b488bd"],
Cell[96802, 2824, 275, 6, 40, "Output",ExpressionUUID->"80b4c6f5-0571-4a89-99dc-1875b990dbd3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97114, 2835, 111, 2, 36, "Input",ExpressionUUID->"b5028d97-3553-4f2d-ac23-722718dd91c5"],
Cell[97228, 2839, 154, 3, 40, "Output",ExpressionUUID->"5420832b-680c-4823-903f-0e5df8e8a235"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97419, 2847, 383, 10, 36, "Input",ExpressionUUID->"63636b38-244a-48c7-bbea-6d8b85960cee"],
Cell[97805, 2859, 179, 3, 40, "Output",ExpressionUUID->"23c8ee17-fb99-464d-8da1-0280d8d4bbe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98021, 2867, 258, 6, 36, "Input",ExpressionUUID->"962b8169-c06e-4544-bea4-40a3fd186c9b"],
Cell[98282, 2875, 9032, 240, 62, "Output",ExpressionUUID->"d53792a7-92bc-4212-bdc3-64b1b3c0ca66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107351, 3120, 212, 4, 36, "Input",ExpressionUUID->"f509cb28-597b-45f0-be8d-065fc7345872"],
Cell[107566, 3126, 1836, 51, 81, "Output",ExpressionUUID->"928f2f5e-c7c8-47cd-ba11-96b5097d690a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109439, 3182, 271, 6, 36, "Input",ExpressionUUID->"c18c4fc8-3217-46f1-8210-cd92577386cf"],
Cell[109713, 3190, 1016, 31, 81, "Output",ExpressionUUID->"bed1a98c-19a1-42a1-810d-d99df04d3c28"]
}, Open  ]],
Cell[110744, 3224, 352, 6, 36, "Input",ExpressionUUID->"5bafe042-ec7c-493e-9b3d-7a76b82f5804"],
Cell[CellGroupData[{
Cell[111121, 3234, 429, 11, 91, "Input",ExpressionUUID->"15b1d369-ef04-46e8-b21d-f68f53dccd40"],
Cell[111553, 3247, 1379, 36, 40, "Output",ExpressionUUID->"9872eaed-b5ec-47fa-ad34-3c1538549cb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112969, 3288, 585, 16, 36, "Input",ExpressionUUID->"0a056487-b85d-4cf1-93f2-da941f58a76d"],
Cell[113557, 3306, 429, 11, 40, "Output",ExpressionUUID->"2102046e-35b4-43af-b144-26275d6aea1e"]
}, Open  ]],
Cell[114001, 3320, 217, 4, 36, "Input",ExpressionUUID->"60c1c749-20f3-4fba-8a2f-f5f6cf5a88c5"],
Cell[114221, 3326, 1961, 63, 252, "Input",ExpressionUUID->"881e1115-9720-46fe-90d2-80e0854c0ea8"],
Cell[CellGroupData[{
Cell[116207, 3393, 462, 20, 251, "Input",ExpressionUUID->"92284809-2446-4e45-8db3-b5916b09c6dc"],
Cell[116672, 3415, 3937, 126, 273, "Output",ExpressionUUID->"9b6a1d26-869e-4a5c-9bc6-07335a32cbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120646, 3546, 436, 19, 251, "Input",ExpressionUUID->"da5f068c-5ea9-41f0-8368-95889dbe524d"],
Cell[121085, 3567, 3962, 126, 273, "Output",ExpressionUUID->"55126a11-3c26-438a-ab9f-4de00935cf47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125084, 3698, 1321, 52, 252, "Input",ExpressionUUID->"e7221398-5eb4-4782-8d8d-cb98085d42a0"],
Cell[126408, 3752, 182, 3, 40, "Output",ExpressionUUID->"fe393116-1722-4b7e-82a9-4bec41fef86a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126627, 3760, 389, 18, 251, "Input",ExpressionUUID->"99c7b09f-2d1b-45f2-96dc-d9da3609fdf1"],
Cell[127019, 3780, 3576, 113, 95, "Output",ExpressionUUID->"7851cc40-62a8-43da-b8a2-0d16494a6ef1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130632, 3898, 1229, 32, 251, "Input",ExpressionUUID->"37e73f82-c8a5-494d-a2fe-21e8e052314c"],
Cell[131864, 3932, 685, 19, 40, "Output",ExpressionUUID->"f88d98f0-3b73-4822-991c-4dcc1210c917"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132586, 3956, 1991, 52, 252, "Input",ExpressionUUID->"59261354-aa49-4562-af2a-c27e2e2d8011"],
Cell[134580, 4010, 392, 9, 25, "Message",ExpressionUUID->"9e7b4205-66e5-48bb-8e76-01fe80d9aa22"],
Cell[134975, 4021, 2650, 63, 68, "Output",ExpressionUUID->"17922105-c391-42f5-b5d1-23e684316499"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137662, 4089, 1086, 37, 252, "Input",ExpressionUUID->"b569b52f-2f1a-4e26-b12a-7ba8516291d0"],
Cell[138751, 4128, 317, 8, 25, "Message",ExpressionUUID->"6de4dc04-18e6-4842-bca0-7f7ce8e0fb60"],
Cell[139071, 4138, 3330, 83, 122, "Output",ExpressionUUID->"23c55b47-94b4-4861-8093-f279f4e2c240"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142438, 4226, 1086, 37, 252, "Input",ExpressionUUID->"d2382b20-d790-43b1-a355-571532eeb682"],
Cell[143527, 4265, 415, 9, 25, "Message",ExpressionUUID->"b233e1a9-f422-4afe-aef8-653a3bf144a1"],
Cell[143945, 4276, 3428, 84, 122, "Output",ExpressionUUID->"cdd93294-a70b-485a-af80-e64289856e9a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147410, 4365, 1326, 40, 252, "Input",ExpressionUUID->"8541213f-c00a-4595-8250-d4bce1ce1d5f"],
Cell[148739, 4407, 392, 10, 25, "Message",ExpressionUUID->"dd3c1e7a-b178-458f-9c53-1c8d02196f48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149168, 4422, 361, 8, 36, "Input",ExpressionUUID->"f6ba9323-fe0d-43ca-8999-497f45e0e33a"],
Cell[149532, 4432, 6712, 181, 174, "Output",ExpressionUUID->"2c727130-ddd6-427a-a986-b8cf33e6713d"]
}, Open  ]]
}
]
*)

